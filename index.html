<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SynkLocal - Guia da Região</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800&family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-main: #F8F9FA;
            --bg-card: #FFFFFF;
            --text-main: #546E7A;
            --primary: #4DB6AC;
            --primary-dark: #26A69A;
            --secondary: #90CAF9;
            --accent: #FFD54F;
            --font-body: 'Nunito', sans-serif;
            --font-display: 'Pacifico', cursive;
        }
        body {
            font-family: var(--font-body);
            background-color: var(--bg-main);
            color: var(--text-main);
        }
        #main-title {
            font-family: var(--font-display);
            color: var(--primary-dark);
        }
        .view { transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out; }
        .hidden-view { display: none; opacity: 0; transform: translateY(10px); }
        #culture-map, #trails-map {
            height: 50vh;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(77, 182, 172, 0.15), 0 8px 10px -6px rgba(77, 182, 172, 0.15);
        }
        .modal-backdrop { transition: opacity 0.3s ease-in-out; }
        .modal-content { transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .scroll-container { scrollbar-width: none; -ms-overflow-style: none; }
        .scroll-container::-webkit-scrollbar { display: none; }
        .skeleton-card { background-color: #ECEFF1; border-radius: 1rem; animation: pulse 1.8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .7; }
        }
        .filter-btn.active, .tab-btn.active {
            color: var(--primary-dark);
            border-color: var(--primary-dark);
            font-weight: 700;
        }
        .filter-btn, .tab-btn { transition: all 0.25s ease-out; }
        .tab-content { transition: opacity 0.3s ease-in-out; }
        .tab-content.hidden { display: none; opacity: 0; }
        
        .timeline {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 0;
        }
        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: #B2DFDB;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
            border-radius: 3px;
        }
        .timeline-container {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
        }
        .timeline-container.left { left: 0; }
        .timeline-container.right { left: 50%; }
        .timeline-container::after {
            content: '';
            position: absolute;
            width: 28px;
            height: 28px;
            right: -14px;
            background-color: white;
            border: 5px solid var(--primary);
            top: 32px;
            border-radius: 50%;
            z-index: 1;
            transition: transform 0.2s ease-out;
        }
        .timeline-container:hover::after {
            transform: scale(1.1);
        }
        .timeline-container.right::after { left: -14px; }
        .timeline-content {
            padding: 20px 30px;
            background-color: white;
            position: relative;
            border-radius: 1rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        .timeline-container:hover .timeline-content {
            transform: translateY(-5px);
        }
        .timeline-content .year {
            font-weight: 800;
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        .timeline-content .title {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--text-main);
            margin-bottom: 0.75rem;
        }
        .timeline-content .event-desc {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #546E7A;
        }
        
        @media screen and (max-width: 768px) {
            .timeline::after { left: 31px; }
            .timeline-container { width: 100%; padding-left: 70px; padding-right: 15px; }
            .timeline-container.left, .timeline-container.right { left: 0%; }
            .timeline-container.left::after, .timeline-container.right::after { left: 15px; }
        }

        .career-card { transition: all 0.3s ease-in-out; }
        .career-card:hover { transform: translateY(-8px); box-shadow: 0 15px 30px -5px rgba(77, 182, 172, 0.25), 0 10px 15px -6px rgba(77, 182, 172, 0.25); }
        
        .leaflet-popup-content-wrapper { border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .leaflet-popup-content { margin: 0; font-family: var(--font-body); width: 250px; }
        .leaflet-popup-content .popup-image { width: 100%; height: 120px; object-fit: cover; border-top-left-radius: 12px; border-top-right-radius: 12px; }
        .leaflet-popup-content .popup-info { padding: 12px; }
        .leaflet-popup-content .popup-title { font-weight: 700; font-size: 1.1rem; margin-bottom: 5px; }
        .leaflet-popup-content .popup-link { font-weight: 600; color: var(--primary-dark); cursor: pointer; }
        .leaflet-routing-container { display: none; }
    </style>
</head>
<body class="antialiased">

    <div id="app" class="container mx-auto p-4 sm:p-6 max-w-7xl">

        <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-lg shadow-sm -mx-4 sm:-mx-6 mb-8 px-4 sm:px-6 py-3 rounded-b-2xl">
            <div class="container mx-auto flex justify-between items-center">
                <h1 id="main-title" class="text-3xl sm:text-4xl cursor-pointer" onclick="App.navigateTo('city-selection')">SynkLocal</h1>
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="#" id="nav-home" onclick="App.navigateTo('home')" class="text-gray-500 hover:text-[var(--primary-dark)] font-medium transition-colors duration-300 hidden">Início</a>
                    <a href="#" id="nav-culture" onclick="App.navigateTo('culture')" class="text-gray-500 hover:text-[var(--primary-dark)] font-medium transition-colors duration-300 hidden">Cultura & Turismo</a>
                    <a href="#" id="nav-events" onclick="App.navigateTo('events')" class="text-gray-500 hover:text-[var(--primary-dark)] font-medium transition-colors duration-300 hidden">Eventos</a>
                    <a href="#" id="nav-careers" onclick="App.navigateTo('careers')" class="text-gray-500 hover:text-[var(--primary-dark)] font-medium transition-colors duration-300 hidden">Carreiras</a>
                    <button id="change-city-btn" onclick="App.navigateTo('city-selection')" class="text-gray-500 hover:text-[var(--primary-dark)] font-medium transition-colors duration-300 hidden">Trocar Localidade</button>
                    <a href="https://wa.me/5524936180096" target="_blank" class="bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-white px-5 py-2 rounded-full shadow-md hover:shadow-lg transition-all transform hover:scale-105 active:scale-95 font-bold">Anuncie Aqui</a>
                </nav>
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="text-[var(--primary-dark)] focus:outline-none p-2 -mr-2 hidden">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                    </button>
                </div>
            </div>
        </header>

        <div id="mobile-menu" class="hidden md:hidden mb-6 bg-white rounded-2xl shadow-lg p-4">
            <a href="#" onclick="App.navigateTo('home'); UI.toggleMobileMenu();" class="block py-3 px-4 hover:bg-teal-50 rounded-lg font-medium">Início</a>
            <a href="#" onclick="App.navigateTo('culture'); UI.toggleMobileMenu();" class="block py-3 px-4 hover:bg-teal-50 rounded-lg font-medium">Cultura & Turismo</a>
            <a href="#" onclick="App.navigateTo('events'); UI.toggleMobileMenu();" class="block py-3 px-4 hover:bg-teal-50 rounded-lg font-medium">Eventos</a>
            <a href="#" onclick="App.navigateTo('careers'); UI.toggleMobileMenu();" class="block py-3 px-4 hover:bg-teal-50 rounded-lg font-medium">Carreiras</a>
            <a href="#" onclick="App.navigateTo('city-selection'); UI.toggleMobileMenu();" class="block py-3 px-4 hover:bg-teal-50 rounded-lg font-medium">Trocar Localidade</a>
            <a href="https://wa.me/5524936180096" target="_blank" class="block mt-4 w-full text-center bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-white px-4 py-3 rounded-lg shadow hover:shadow-md font-bold">Anuncie Aqui</a>
        </div>

        <main>
            <div id="city-selection-view" class="view">
                <section class="text-center mb-10 md:mb-12">
                    <h2 class="text-3xl sm:text-4xl md:text-5xl font-extrabold mb-4 text-[var(--text-main)] tracking-tight">Bem-vindo ao SynkLocal! ✨</h2>
                    <p class="text-base sm:text-lg text-gray-500 max-w-2xl mx-auto">Selecione uma localidade para começar a explorar o que há de melhor.</p>
                </section>
                <div id="city-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8"></div>
            </div>

            <div id="home-view" class="hidden-view view"></div>
            
            <div id="culture-view" class="hidden-view view">
                 <button onclick="App.navigateTo('home')" class="bg-white text-gray-800 px-5 py-2.5 rounded-full mb-6 hover:bg-gray-100 transition-all shadow-md active:scale-95 text-sm font-semibold">← Voltar para o Início</button>
                 <div id="culture-content"></div>
            </div>

            <div id="careers-view" class="hidden-view view">
                <button onclick="App.navigateTo('home')" class="bg-white text-gray-800 px-5 py-2.5 rounded-full mb-6 hover:bg-gray-100 transition-all shadow-md active:scale-95 text-sm font-semibold">← Voltar para o Início</button>
                <div id="careers-content"></div>
            </div>
            
            <div id="food-guide-view" class="hidden-view view">
                <button onclick="App.navigateTo('home')" class="bg-white text-gray-800 px-5 py-2.5 rounded-full mb-6 hover:bg-gray-100 transition-all shadow-md active:scale-95 text-sm font-semibold">← Voltar para o Início</button>
                <div id="food-guide-content"></div>
            </div>

            <div id="events-view" class="hidden-view view">
                <button onclick="App.navigateTo('home')" class="bg-white text-gray-800 px-5 py-2.5 rounded-full mb-6 hover:bg-gray-100 transition-all shadow-md active:scale-95 text-sm font-semibold">← Voltar para o Início</button>
                <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6">
                    <h2 id="events-title" class="text-2xl sm:text-3xl font-bold tracking-tight mb-4 sm:mb-0">Agenda de Eventos</h2>
                </div>
                <div id="event-filters" class="flex overflow-x-auto scroll-container gap-3 mb-8 pb-2"></div>
                <div id="happening-now-section"></div>
                <div id="upcoming-events-section"></div>
                <p id="no-events" class="hidden text-center text-gray-500 mt-10 py-10">Nenhum evento encontrado com os filtros selecionados.</p>
            </div>

            <div id="results-view" class="hidden-view view">
                <button onclick="App.navigateTo('home')" class="bg-white text-gray-800 px-5 py-2.5 rounded-full mb-6 hover:bg-gray-100 transition-all shadow-md active:scale-95 text-sm font-semibold">← Voltar para o Início</button>
                <div class="lg:flex lg:space-x-8">
                    <aside class="lg:w-1/4 mb-8 lg:mb-0">
                        <div class="lg:sticky top-28">
                            <h3 class="text-xl font-bold mb-4 tracking-tight">Filtros</h3>
                            <div class="space-y-6 bg-white p-4 sm:p-6 rounded-3xl shadow-xl shadow-teal-100/50">
                                <div>
                                    <label for="search-input-results" class="font-semibold block mb-2 text-sm">Buscar por termo:</label>
                                    <input id="search-input-results" type="text" placeholder="Buscar..." class="w-full p-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[var(--primary)]">
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2 text-sm">Bairro/Distrito</h4>
                                    <div id="filter-neighborhood" class="space-y-2 max-h-48 overflow-y-auto pr-2"></div>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2 text-sm">Status</h4>
                                    <div id="filter-status" class="space-y-2">
                                        <div class="flex items-center"><input type="radio" id="status-all" name="status" value="all" class="h-4 w-4 text-[var(--primary-dark)] border-gray-300 focus:ring-[var(--primary)]" checked><label for="status-all" class="ml-2 text-sm">Todos</label></div>
                                        <div class="flex items-center"><input type="radio" id="status-open" name="status" value="open" class="h-4 w-4 text-[var(--primary-dark)] border-gray-300 focus:ring-[var(--primary)]"><label for="status-open" class="ml-2 text-sm">Aberto Agora</label></div>
                                    </div>
                                </div>
                                <button onclick="App.applyFilters()" class="w-full bg-[var(--primary)] text-white px-6 py-3 rounded-lg font-semibold hover:bg-[var(--primary-dark)] transition-all transform active:scale-95">Aplicar Filtros</button>
                            </div>
                        </div>
                    </aside>
                    <div class="lg:w-3/4">
                        <h2 id="results-title" class="text-2xl sm:text-3xl font-bold mb-6 tracking-tight">Resultados</h2>
                        <div id="results-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 md:gap-8"></div>
                        <p id="no-results" class="hidden text-center text-gray-500 mt-10 py-16 bg-white rounded-3xl shadow-lg shadow-teal-100/50">Nenhuma empresa encontrada com os critérios selecionados.</p>
                    </div>
                </div>
            </div>

            <div id="details-view" class="hidden-view view bg-white rounded-3xl shadow-2xl shadow-teal-200/50 p-4 sm:p-6 md:p-8"></div>
        </main>
        
        <div id="quote-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4 hidden opacity-0 modal-backdrop">
            <div id="quote-modal-content" class="bg-white rounded-3xl shadow-2xl p-6 sm:p-8 w-full max-w-md transform scale-95 modal-content max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold tracking-tight">Pedir Orçamento ✉️</h3>
                    <button onclick="UI.closeModal('quote-modal')" class="text-gray-400 hover:text-gray-800 text-3xl transition-colors">×</button>
                </div>
                <div id="quote-form-container">
                    <p class="text-gray-600 mb-6">Preencha os dados e sua solicitação será enviada para <span id="modal-company-name" class="font-bold"></span>.</p>
                    <form onsubmit="event.preventDefault(); App.sendQuote();">
                        <div class="space-y-4">
                            <input type="text" placeholder="Seu Nome" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[var(--primary)]" required>
                            <input type="email" placeholder="Seu E-mail" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[var(--primary)]" required>
                            <textarea placeholder="Descreva o que você precisa..." class="w-full p-3 border border-gray-200 rounded-xl h-24 focus:ring-2 focus:ring-[var(--primary)]" required></textarea>
                            <button type="submit" class="w-full bg-[var(--primary)] text-white px-6 py-3 rounded-xl font-semibold hover:bg-[var(--primary-dark)] transition-all transform active:scale-95">Enviar Solicitação</button>
                        </div>
                    </form>
                </div>
                <div id="quote-success-message" class="hidden text-center py-8">
                    <h3 class="text-2xl font-bold text-green-500 mb-4">Enviado com Sucesso! 🎉</h3>
                    <p class="text-gray-600">Sua solicitação foi enviada. A empresa entrará em contato em breve.</p>
                    <button onclick="UI.closeModal('quote-modal')" class="mt-6 w-full bg-[var(--primary)] text-white px-6 py-3 rounded-xl font-semibold hover:bg-[var(--primary-dark)] transition-colors">Fechar</button>
                </div>
            </div>
        </div>

        <div id="cv-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[100] flex items-center justify-center p-4 hidden opacity-0 modal-backdrop">
            <div id="cv-modal-content" class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-3xl transform scale-95 modal-content max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4 border-b pb-3">
                    <h3 class="text-xl sm:text-2xl font-bold tracking-tight">Modelo de Currículo 📄</h3>
                    <button onclick="UI.closeModal('cv-modal')" class="text-gray-400 hover:text-gray-800 text-3xl transition-colors">×</button>
                </div>
                <div id="cv-content" class="text-sm text-gray-700 leading-relaxed"></div>
            </div>
        </div>

        <footer class="text-center mt-16 pt-8 border-t border-teal-100">
            <div class="flex justify-center space-x-6 text-gray-500 mb-4">
                <a href="#" class="hover:text-[var(--primary-dark)] transition-colors">Sobre Nós</a>
                <a href="https://wa.me/5524936180096" target="_blank" class="hover:text-[var(--primary-dark)] transition-colors">Anuncie</a>
                <a href="#" class="hover:text-[var(--primary-dark)] transition-colors">Contato</a>
            </div>
            <p class="text-gray-400 text-sm">© 2025 SynkLocal. Todos os direitos reservados.</p>
        </footer>
    </div>
    
    <button id="scrollToTopBtn" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="fixed bottom-6 right-6 bg-[var(--primary)] text-white p-3 rounded-full shadow-lg hover:bg-[var(--primary-dark)] focus:outline-none opacity-0 transform translate-y-4 hover:scale-110 active:scale-100 transition-all">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
        </svg>
    </button>

<script>
// Objeto de dados (DB) adaptado para Rio Claro-RJ e Lídice
const DB = {
    cities: [
        { 
            name: "Rio Claro", 
            image: "https://www.ferias.tur.br/imgs/2335/rioclaro-rj/g_pousada-fazenda-sao-joaquim-01.jpg", 
            lat: -22.724, 
            lon: -44.135,
            culture: {
                timeline: [
                    { year: "Século 18", title: "Caminhos do Ouro", event: "A região começa a ser desbravada como rota de passagem para o ouro vindo de Minas Gerais, com a abertura do 'Caminho Novo'." },
                    { year: "1822", title: "O Berço do Café", event: "É fundada a Freguesia de São João Batista do Rio Claro, marcando o início da ascensão da região como uma das maiores produtoras de café do Império." },
                    { year: "1849", title: "Elevação à Vila", event: "Rio Claro é elevada à categoria de Vila, consolidando sua importância econômica e política no Vale do Paraíba, graças aos 'Barões do Café'." },
                    { year: "1938", title: "A Chegada das Águas", event: "Inicia-se a construção da Represa de Ribeirão das Lajes, um marco da engenharia que alterou a paisagem e impulsionou o desenvolvimento da região." },
                    { year: "1942", title: "Memória Submersa", event: "A antiga vila de São João Marcos é inundada para a ampliação da represa. Hoje, o local é um parque arqueológico e ambiental que resgata essa história." },
                    { year: "Hoje", title: "Turismo e Natureza", event: "Rio Claro se destaca pelo turismo histórico, com suas fazendas centenárias, e pelo ecoturismo, com cachoeiras e trilhas na Mata Atlântica." }
                ],
                gastronomia: [
                    { nome: "Comida Tropeira", imagem: "https://www.receitasnestle.com.br/sites/default/files/srh_recipes/80d5d91b377b35da2338d66e35ba21ee.jpg", desc: "Herança dos viajantes, pratos como feijão tropeiro e paçoca de carne são fortes na culinária local." },
                    { nome: "Doces Caseiros", imagem: "https://revistacasaejardim.globo.com/path/mvp/original/2021/07/28/doce-de-leite-caseiro-com-apenas-2-ingredientes-1-820158.jpg", desc: "Compotas, doces de leite e de frutas, feitos artesanalmente nas fazendas e sítios da região." }
                ],
                legends: [
                     { title: "A Lenda do Túnel dos Escravos", image: "https://upload.wikimedia.org/wikipedia/commons/2/2f/Fazenda_do_Salto_-_Rio_Claro_-_panoramio.jpg", story: "Diz a lenda que as grandes fazendas de café da época do Império, como a Fazenda do Salto, eram conectadas por uma rede de túneis subterrâneos. Esses túneis teriam sido construídos por escravos e serviriam como rota de fuga secreta ou para o transporte de riquezas sem o conhecimento dos fiscais da Coroa. Muitos caçadores de tesouros já exploraram a região em busca de entradas secretas para esses túneis, sonhando em encontrar ouro ou joias dos antigos barões do café. Embora nunca comprovada, a história alimenta a imaginação e o mistério que pairam sobre os casarões históricos de Rio Claro." }
                ],
                peopleStories: [
                    { name: "Joaquim José de Sousa Breves", photo: "https://upload.wikimedia.org/wikipedia/commons/a/a2/Joaquim_Jos%C3%A9_de_Souza_Breves.jpg", story: "Conhecido como o 'Rei do Café' no Brasil Império, Joaquim Breves foi um dos homens mais ricos e poderosos de seu tempo. Sua fortuna era imensurável, com mais de 50 fazendas de café espalhadas pelo Vale do Paraíba, incluindo vastas terras na região de Rio Claro. Ele personificou a opulência e o poder dos 'Barões do Café', influenciando a política e a economia de todo o país. As fazendas históricas que hoje encantam os turistas são um legado direto dessa era de ouro, moldada por figuras como Breves." }
                ],
                gallery: [
                    "https://mapaderiodejaneiro.com.br/wp-content/uploads/2021/04/parque-arqueologico-sao-joao-marcos.jpg", 
                    "https://i0.wp.com/diariodovale.com.br/wp-content/uploads/2021/07/fazenda-sao-joaquim-da-grama-1.jpg", 
                    "https://secretarias.rioclaro.rj.gov.br/turismo/wp-content/uploads/sites/13/2022/10/WhatsApp-Image-2022-10-21-at-12.01.27.jpeg"
                ],
                tourism: {
                    intro: "Terra dos Barões do Café, Rio Claro te convida para uma viagem no tempo por suas fazendas históricas e a se refrescar em suas belas cachoeiras.",
                    spots: [
                        { id: 'spot-rc-1', name: "Parque Arqueológico de São João Marcos", type: "História e Cultura", category: "Cultura", lat: -22.759, lon: -44.049, tip: "Participe de uma visita guiada para entender a rica história da cidade que foi submersa.", description: "Ruínas da antiga cidade inundada pela represa de Lajes. Um museu a céu aberto que conta a história da região.", gallery: ["https://www.historiadorio.com.br/wp-content/uploads/2012/10/sao-joao-marcos-1-1.jpg", "https://vejario.abril.com.br/wp-content/uploads/2016/12/cidade-submersa-de-sao-joao-marcos-no-rio-de-janeiro-tera-ruinas-visitaveis-20110302143003233.jpg"] },
                        { id: 'spot-rc-2', name: "Fazenda São Joaquim da Grama", type: "Turismo Rural", category: "Lazer", lat: -22.682, lon: -44.093, tip: "Agende um almoço na fazenda para provar a autêntica comida tropeira feita no fogão a lenha.", description: "Uma das mais belas e bem preservadas fazendas do ciclo do café, oferece visitas guiadas, hospedagem e um mergulho na história.", gallery: ["https://www.fazendasaojoaquim.com.br/wp-content/uploads/2018/12/home-01.jpg"] },
                        { id: 'spot-rc-3', name: "Cachoeira Sete Quedas", type: "Natureza e Aventura", category: "Natureza", lat: -22.691, lon: -44.184, tip: "O acesso exige uma pequena trilha. Vá de tênis e leve repelente.", description: "Sequência de quedas d'água que formam piscinas naturais de água cristalina, ideais para um banho refrescante.", gallery: ["https://live.staticflickr.com/502/19131609104_0b7b1b5e5c_b.jpg"] }
                    ]
                }
            }
        },
        { 
            name: "Lídice", 
            image: "https://mapio.net/images-p/11267425.jpg", 
            lat: -22.775, 
            lon: -44.201,
            culture: {
                timeline: [
                    { year: "1942", title: "O Massacre na Tchecoslováquia", event: "A vila de Lídice, na antiga Tchecoslováquia, é completamente destruída por forças nazistas como retaliação pela morte de um oficial alemão." },
                    { year: "1944", title: "Um Ato de Solidariedade", event: "O então distrito de Santo Antônio do Capivari, em Rio Claro, é rebatizado para Lídice, em um gesto de solidariedade e homenagem à vila mártir tcheca." },
                    { year: "1947", title: "Monumento à Paz", event: "É inaugurado o monumento em homenagem a Lídice, com um busto do presidente tcheco Edvard Beneš, simbolizando a amizade entre os povos e a luta pela paz." },
                    { year: "Hoje", title: "Refúgio e Memória", event: "Lídice é um distrito tranquilo, conhecido por sua natureza exuberante, cachoeiras e por manter viva a memória de sua comovente história de origem." }
                ],
                peopleStories: [
                    { name: "Dr. Edvard Beneš", photo: "https://upload.wikimedia.org/wikipedia/commons/e/e3/Edvard_Bene%C5%A1_LOC_31555.jpg", story: "Presidente da Tchecoslováquia no exílio durante a Segunda Guerra Mundial, Edvard Beneš tornou-se um símbolo da resistência contra a tirania nazista. A destruição da vila de Lídice em seu país chocou o mundo. Em um gesto de solidariedade, o Brasil, através de seus diplomatas e da comunidade local, renomeou o distrito de Santo Antônio do Capivari para Lídice. O busto de Beneš na praça central não é apenas uma homenagem a ele, mas um lembrete perpétuo da amizade entre nações e da importância da paz." }
                ],
                gallery: [
                    "https://upload.wikimedia.org/wikipedia/commons/1/10/Pra%C3%A7a_de_L%C3%ADdice%2C_Rio_Claro%2C_RJ.jpg",
                    "https://www.prefeituraderioclaro.com.br/images/noticias/noticia_5331_1.jpg",
                    "https://i.ytimg.com/vi/bX7j-eY_9Xw/maxresdefault.jpg"
                ],
                tourism: {
                    intro: "Conheça a história de solidariedade que deu nome a este distrito e explore suas belezas naturais, como rios e cachoeiras perfeitas para o ecoturismo.",
                    spots: [
                        { id: 'spot-li-1', name: "Cachoeira da Pamonha", type: "Natureza e Lazer", category: "Natureza", lat: -22.815, lon: -44.189, tip: "O local possui um bar simples que vende a famosa pamonha. Não deixe de provar!", description: "Bela cachoeira com poço para banho e um bar rústico, muito procurada nos fins de semana para relaxar.", gallery: ["https://i.ytimg.com/vi/bX7j-eY_9Xw/maxresdefault.jpg"] },
                        { id: 'spot-li-2', name: "Praça Lídice", type: "História", category: "Cultura", lat: -22.775, lon: -44.200, tip: "Leia as placas no monumento para entender a história completa do nome da cidade.", description: "O coração do distrito, onde se encontra o monumento em homenagem à vila tcheca e a igreja local. Um lugar de paz e memória.", gallery: ["https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Pra%C3%A7a_de_L%C3%ADdice%2C_Rio_Claro%2C_RJ.jpg/1280px-Pra%C3%A7a_de_L%C3%ADdice%2C_Rio_Claro%2C_RJ.jpg"] }
                    ]
                }
            }
        }
    ],
    categories: [
        { name: "Alimentação", icon: "🍔" }, { name: "Saúde", icon: "🩺" },
        { name: "Serviços", icon: "💼" }, { name: "Para o Lar", icon: "🏠" },
        { name: "Comércio", icon: "🛒" }, { name: "Beleza", icon: "💅" },
        { name: "Educação", icon: "📚" }, { name: "Automotivo", icon: "🚗" },
        { name: "Pets", icon: "🐾" }, { name: "Lazer", icon: "🎉" },
        { name: "Promoções", icon: "🔥" },
    ],
    companies: [
        // Empresas de Rio Claro - RJ
        {
            id: "empresa-rc-01", cidade: "Rio Claro - RJ", nome: "Restaurante Fazenda do Sol", logotipo: "https://placehold.co/200x200/FFB300/ffffff?text=FS",
            descricao: "O autêntico sabor da roça no coração de Rio Claro. Comida feita no fogão a lenha, com ingredientes frescos e um ambiente acolhedor.",
            endereco: { rua: "Rua XV de Novembro, 150", bairro: "Centro", cidade: "Rio Claro - RJ", lat: -22.723, lon: -44.136 },
            contato: { whatsapp: "+5524912345678" },
            horario_funcionamento: { sexta: "11:00-15:00", sabado: "11:00-16:00", domingo: "11:00-16:00" },
            categorias: ["Alimentação", "Restaurantes", "Comida Mineira"], palavras_chave: ["comida tropeira", "fogão a lenha", "almoço", "fazenda"],
            galeria_fotos: ["https://media-cdn.tripadvisor.com/media/photo-s/0f/b7/95/59/restaurante-da-fazenda.jpg"],
            avaliacoes: [{ usuario: "Carlos M.", nota: 5, comentario: "Comida maravilhosa, com gostinho de casa da avó!" }],
            plano: "destaque", data_cadastro: "2025-01-20T10:00:00Z", destaques: ["Feijoada aos Sábados", "Música ao Vivo", "Doces Caseiros"], verificado: true
        },
        {
            id: "empresa-rc-02", cidade: "Rio Claro - RJ", nome: "Pousada Recanto das Águas", logotipo: "https://placehold.co/200x200/4DD0E1/ffffff?text=RA",
            descricao: "Seu refúgio na natureza. Chalés confortáveis, piscina, e acesso a trilhas. Perfeito para relaxar e se reconectar.",
            endereco: { rua: "Estrada das Sete Quedas, km 2", bairro: "Zona Rural", cidade: "Rio Claro - RJ", lat: -22.695, lon: -44.180 },
            contato: { whatsapp: "+5524923456789" },
            horario_funcionamento: { segunda: "08:00-20:00", terca: "08:00-20:00", quarta: "08:00-20:00", quinta: "08:00-20:00", sexta: "08:00-22:00", sabado: "08:00-22:00", domingo: "08:00-18:00" },
            categorias: ["Lazer", "Hospedagem"], palavras_chave: ["pousada", "hotel", "natureza", "cachoeira", "descanso"],
            galeria_fotos: ["https://media-cdn.tripadvisor.com/media/photo-s/0d/f9/57/5a/pousada-recanto-das-aguas.jpg"],
            avaliacoes: [{ usuario: "Ana P.", nota: 5, comentario: "Lugar incrível para relaxar. O café da manhã é espetacular!" }],
            plano: "destaque", data_cadastro: "2025-02-15T18:00:00Z", destaques: ["Chalés com Lareira", "Piscina Natural", "Café da Manhã Colonial"], verificado: true, delivery: false, acceptsReservations: true, outdoorSeating: true
        },
        {
            id: "empresa-rc-03", cidade: "Rio Claro - RJ", nome: "Agropecuária Vale Verde", logotipo: "https://placehold.co/200x200/81C784/ffffff?text=VV",
            descricao: "Tudo para o homem do campo e para o seu jardim. Ferramentas, rações, sementes e consultoria especializada.",
            endereco: { rua: "Av. João Batista, 500", bairro: "Centro", cidade: "Rio Claro - RJ", lat: -22.725, lon: -44.138 },
            contato: { whatsapp: "+5524934567890" },
            horario_funcionamento: { segunda: "08:00-18:00", terca: "08:00-18:00", quarta: "08:00-18:00", quinta: "08:00-18:00", sexta: "08:00-18:00", sabado: "08:00-13:00" },
            categorias: ["Comércio", "Serviços", "Pets"], palavras_chave: ["agropecuária", "ração", "ferramentas", "jardinagem"],
            galeria_fotos: ["https://www.cnabrasil.org.br/assets/images/galeria/agro-brasilia-3.jpeg"],
            avaliacoes: [{ usuario: "José F.", nota: 4, comentario: "Sempre encontro o que preciso para meu sítio." }],
            plano: "normal", data_cadastro: "2025-03-10T09:00:00Z", destaques: ["Entrega na Zona Rural", "Variedade de Rações"], verificado: false
        },
        {
            id: "empresa-rc-04", cidade: "Rio Claro - RJ", nome: "Farmácia Central", logotipo: "https://placehold.co/200x200/64B5F6/ffffff?text=FC",
            descricao: "Cuidando da saúde da família rioclarense. Medicamentos, perfumaria e atendimento farmacêutico de confiança.",
            endereco: { rua: "Praça da Matriz, 25", bairro: "Centro", cidade: "Rio Claro - RJ", lat: -22.722, lon: -44.135 },
            contato: { whatsapp: "+5524945678901" },
            horario_funcionamento: { segunda: "07:30-21:00", terca: "07:30-21:00", quarta: "07:30-21:00", quinta: "07:30-21:00", sexta: "07:30-21:00", sabado: "08:00-20:00" },
            categorias: ["Saúde", "Farmácias"], palavras_chave: ["remédio", "farmácia", "saúde", "perfumaria"],
            galeria_fotos: ["https://s2-g1.glbimg.com/pL2MDHR-qXpC52CV8IqUa0B-oEU=/0x0:2048x1365/984x0/smart/filters:strip_icc()/i.s3.glbimg.com/v1/AUTH_59edd422c0c84a879bd37670ae4f538a/internal_photos/bs/2023/X/Y/iM952xQZqlpB9a838MZA/farmacia.jpg"],
            avaliacoes: [{ usuario: "Maria S.", nota: 5, comentario: "Atendimento sempre muito atencioso." }],
            plano: "destaque", data_cadastro: "2025-04-01T08:00:00Z", destaques: ["Entrega Rápida", "Farmacêutico em Tempo Integral"], verificado: true
        },
        // Empresas de Lídice
        {
            id: "empresa-li-01", cidade: "Lídice", nome: "Bar e Restaurante da Cachoeira", logotipo: "https://placehold.co/200x200/FFEE58/ffffff?text=BC",
            descricao: "A parada obrigatória em Lídice. Cerveja gelada, porções generosas, a famosa pamonha e o som relaxante da cachoeira.",
            endereco: { rua: "Estrada da Pamonha, s/n", bairro: "Zona Rural", cidade: "Lídice", lat: -22.814, lon: -44.190 },
            contato: { whatsapp: "+5524956789012" },
            horario_funcionamento: { quinta: "10:00-18:00", sexta: "10:00-20:00", sabado: "09:00-22:00", domingo: "09:00-19:00" },
            categorias: ["Alimentação", "Bares", "Lazer"], palavras_chave: ["pamonha", "cachoeira", "bar", "cerveja", "porções"],
            galeria_fotos: ["https://i.ytimg.com/vi/W4a06n4f6mY/maxresdefault.jpg"],
            avaliacoes: [{ usuario: "Fernando P.", nota: 5, comentario: "Pamonha deliciosa e lugar incrível para passar o dia." }],
            plano: "normal", data_cadastro: "2025-05-20T11:00:00Z", destaques: ["Pamonha Doce e Salgada", "Música ao Vivo aos Domingos", "Acesso à Cachoeira"], verificado: true, delivery: false, acceptsReservations: false, outdoorSeating: true
        },
        {
            id: "empresa-li-02", cidade: "Lídice", nome: "Mercearia do Zé", logotipo: "https://placehold.co/200x200/78909C/ffffff?text=MZ",
            descricao: "O ponto de encontro do distrito. Temos de tudo um pouco: secos e molhados, frios, bebidas e aquela conversa boa.",
            endereco: { rua: "Rua Principal, 10", bairro: "Centro", cidade: "Lídice", lat: -22.774, lon: -44.200 },
            contato: { whatsapp: "+5524967890123" },
            horario_funcionamento: { segunda: "07:00-19:00", terca: "07:00-19:00", quarta: "07:00-19:00", quinta: "07:00-19:00", sexta: "07:00-19:00", sabado: "07:00-17:00" },
            categorias: ["Comércio", "Supermercados"], palavras_chave: ["mercado", "mercearia", "compras", "bebidas"],
            galeria_fotos: ["https://www.infomoney.com.br/wp-content/uploads/2021/04/bares-restaurantes-abre-e-fecha-governo-de-sao-paulo.jpg"],
            avaliacoes: [{ usuario: "Dona Cida", nota: 5, comentario: "O Zé sempre tem o que a gente precisa. Uma mão na roda!" }],
            plano: "normal", data_cadastro: "2025-06-10T07:00:00Z", destaques: ["Pão Fresco de Manhã", "Queijo da Região"], verificado: false
        }
    ],
    events: [
        { id: "evento-rc-01", cidade: "Rio Claro - RJ", nome: "Festival do Vale do Café", descricao: "Rio Claro participa do tradicional festival com concertos de música clássica e instrumental nas fazendas históricas. Uma experiência única!", data_inicio: "2025-07-25T19:00:00-03:00", data_fim: "2025-07-27T22:00:00-03:00", local: "Fazendas da Região", imagem: "https://www.festivalvaledocafe.com/wp-content/uploads/2023/07/2023-06-23-0005-scaled.jpg", categoria: "Cultura", popular: true, organizador: "Associação do Vale do Café", preco: "Consultar", publico_alvo: "Adultos", tags: ["Música Clássica", "História", "Gastronomia"] },
        { id: "evento-li-01", cidade: "Lídice", nome: "Festa de Santo Antônio do Capivari", descricao: "A tradicional festa do antigo padroeiro do distrito, com missa, procissão, leilão de gado, shows de forró e barracas com comidas típicas.", data_inicio: "2025-06-13T18:00:00-03:00", data_fim: "2025-06-15T23:59:00-03:00", local: "Praça de Lídice", imagem: "https://www.prefeituraderioclaro.com.br/images/noticias/noticia_5331_1.jpg", categoria: "Festa", popular: true, organizador: "Comunidade Local", preco: "Gratuito", publico_alvo: "Famílias", tags: ["Festa Junina", "Tradição", "Música ao Vivo"] }
    ],
    jobs: [
        { id: "vaga-rc-01", cidade: "Rio Claro - RJ", title: "Recepcionista de Pousada (Fim de Semana)", company: "Pousada Recanto das Águas", description: "Buscamos uma pessoa comunicativa e organizada para recepcionar nossos hóspedes aos fins de semana. Necessário ser proativo e gostar de lidar com o público.", requirements: ["Ensino Médio Completo", "Boa comunicação", "Disponibilidade aos Sábados e Domingos"], contact: "rh.recanto@example.com" }
    ],
    careerGuide: {
        highSchool: {
            intro: "O ensino médio é a fase perfeita para explorar, descobrir paixões e começar a desenhar o mapa do seu futuro. Não tenha pressa para decidir, mas aproveite para experimentar!",
            interests: [
                { icon: "💻", title: "Tecnologia", description: "Gosta de games, apps e computadores? Carreiras em programação, design digital e análise de dados estão em alta." },
                { icon: "❤️‍🩹", title: "Saúde & Cuidado", description: "Se você se importa com o bem-estar dos outros, áreas como enfermagem, fisioterapia e psicologia podem ser o seu caminho." },
                { icon: "🎨", title: "Artes & Criatividade", description: "Para quem ama se expressar, o mundo do design, música, moda e artes visuais é cheio de oportunidades." },
                { icon: "⚖️", title: "Humanas & Sociais", description: "Curte história, debates e entender a sociedade? Direito, jornalismo e serviço social são áreas fascinantes." },
            ],
            firstSteps: [
                { icon: "🎓", title: "Cursos Livres e Oficinas", description: "Participe de cursos online ou presenciais sobre temas que te interessam. É uma ótima forma de testar uma área sem compromisso." },
                { icon: "🙌", title: "Voluntariado", description: "Ajudar em uma causa social desenvolve habilidades importantes e te dá uma nova perspectiva sobre o mundo e suas necessidades." },
                { icon: "💬", title: "Converse com Profissionais", description: "Chame para um café (ou uma call) pessoas que trabalham em áreas que você admira. Pergunte sobre o dia a dia e os desafios da profissão." },
            ]
        },
        postHighSchool: {
            intro: "O 'terceirão' acabou, e agora? Calma, existem muitos caminhos possíveis e nenhum deles é uma sentença definitiva. O importante é dar o próximo passo com confiança.",
            paths: [
                { icon: "📚", title: "Vestibular e ENEM", description: "A porta de entrada para a universidade. Exige dedicação e estudo, mas abre um leque de carreiras de nível superior.", pros: "Formação aprofundada, networking, acesso a profissões regulamentadas.", cons: "Alta concorrência, pode ser um processo longo e estressante." },
                { icon: "🛠️", title: "Cursos Técnicos", description: "Formação rápida e focada nas necessidades do mercado de trabalho. Ideal para quem quer entrar logo na área.", pros: "Rápida inserção no mercado, custo mais baixo, aprendizado prático.", cons: "Foco muito específico, pode limitar a mudança de carreira futura." },
                { icon: "💼", title: "Primeiro Emprego", description: "Entrar no mercado de trabalho para ganhar experiência, independência financeira e entender como as coisas funcionam na prática.", pros: "Experiência prática, desenvolvimento de soft skills, independência.", cons: "Pode ser difícil conciliar com estudos, salários iniciais mais baixos." },
                { icon: "💡", title: "Empreendedorismo", description: "Transformar uma ideia em um negócio. Começar pequeno, testar o mercado e aprender a ser seu próprio chefe.", pros: "Autonomia, potencial de ganhos, realização pessoal.", cons: "Alto risco, exige múltiplas habilidades, jornada solitária no início." },
            ],
            tools: [
                { id: "cv", icon: "📄", title: "Modelo de Currículo", description: "Veja um modelo de currículo para quem busca o primeiro emprego e adapte com suas informações." },
                { id: "interview", icon: "🎤", title: "Preparação para Entrevistas", description: "Dicas de como se portar, o que responder e como se destacar em uma entrevista de emprego." },
                { id: "courses", icon: "🌐", title: "Cursos Online Gratuitos", description: "Plataformas como Coursera, edX e a Fundação Bradesco oferecem cursos para turbinar seu conhecimento." },
            ]
        },
        localOpportunities: {
            intro: "A região de Rio Claro é um polo de turismo, agronegócio e serviços. Conhecer as vocações locais pode te ajudar a escolher uma carreira com grande potencial de crescimento aqui mesmo.",
            professions: [
                { icon: "🏕️", title: "Turismo e Hotelaria", description: "O coração da economia local. Carreiras como guia turístico, recepcionista de hotel/pousada e gestor de eventos são sempre requisitadas.", needs: "Cursos técnicos em turismo/hotelaria, graduação em Turismo." },
                { icon: "🌱", title: "Agronegócio", description: "Da agricultura familiar à pecuária, a região é forte no campo. Profissionais como técnico agrícola e zootecnista encontram boas oportunidades.", needs: "Cursos técnicos (SENAR), graduação em Agronomia." },
                { icon: "❤️‍🩹", title: "Saúde e Bem-estar", description: "Com o crescimento da população e do turismo, a demanda por enfermeiros, técnicos em enfermagem e fisioterapeutas só aumenta.", needs: "Cursos técnicos e graduação na área da saúde." },
                { icon: "🛠️", title: "Serviços Locais", description: "Toda cidade precisa de bons profissionais de serviços: eletricistas, mecânicos, cabeleireiros e cozinheiros são essenciais para a comunidade.", needs: "Cursos profissionalizantes, experiência prática." },
            ],
            institutions: [
                { name: "FAETERJ - Barra Mansa (próximo)", link: "https://www.faeterj-bm.com.br/" },
                { name: "CEFET/RJ - Valença (próximo)", link: "https://www.cefet-rj.br/index.php/valenca" },
                { name: "SENAR Rio de Janeiro", link: "https://www.senarj.org.br/" },
                { name: "CVT - Rio Claro (Centro Vocacional Tecnológico)", link: "#" }
            ]
        },
        entrepreneurship: {
            intro: "Sonha em ser seu próprio chefe? Empreender é transformar uma paixão em um negócio que gera valor para a comunidade. A região de Rio Claro é um terreno fértil para novas ideias, conectando o turismo, o agronegócio e os serviços locais. Aqui você encontrará um guia prático para dar vida ao seu projeto.",
            firstSteps: [
                { icon: "💡", title: "Valide Sua Ideia", description: "Antes de tudo, converse com potenciais clientes. Sua ideia resolve um problema real? As pessoas pagariam por isso? Um bom termômetro é criar um grupo de WhatsApp e ver o interesse." },
                { icon: "📝", title: "Plano de Negócios Simples", description: "Esqueça documentos complexos. Responda: O que eu vendo? Para quem? Onde? Como vou divulgar? Quanto preciso para começar e qual será meu preço?" },
                { icon: "💰", title: "Comece Pequeno (MEI)", description: "Formalizar-se como Microempreendedor Individual (MEI) é o caminho mais fácil e barato para ter um CNPJ, emitir notas fiscais e acessar benefícios. O processo é 100% online." },
                { icon: "🚀", title: "Divulgue Seu Negócio", description: "Use o poder das redes sociais (Instagram é essencial!), crie um Perfil de Empresa no Google Maps (é grátis!) e participe de feiras e eventos locais para se tornar conhecido." }
            ],
            businessIdeas: [
                { icon: "🚵", title: "Ecoturismo e Aventura", description: "Crie roteiros guiados de trilhas para as cachoeiras, oferecendo pacotes com lanche (piquenique) e transporte." },
                { icon: "🧀", title: "Cestas de Produtos da Roça", description: "Monte e venda cestas com os melhores produtos da região (queijos, doces, cachaças, café) e entregue em domicílio." },
                { icon: "📸", title: "Fotografia de Natureza e Eventos", description: "A beleza da região é um cenário perfeito para ensaios fotográficos. Ofereça seus serviços para turistas e em eventos locais." },
                { icon: "📱", title: "Marketing Digital para Pousadas", description: "Muitas pousadas e restaurantes locais não sabem como usar a internet para atrair mais turistas. Ofereça serviços de gestão de redes sociais e criação de anúncios." }
            ],
            commonChallenges: [
                { title: "Sazonalidade do Turismo", tip: "Crie promoções e eventos na baixa temporada para atrair o público local e de cidades vizinhas. Parcerias com empresas podem garantir um fluxo constante." },
                { title: "Medo de Fracassar", tip: "Encare cada passo como um aprendizado. Comece pequeno para que os riscos sejam controlados. Lembre-se: feito é melhor que perfeito. O importante é começar." },
                { title: "Misturar Finanças", tip: "Desde o primeiro dia, tenha uma conta bancária separada para o negócio, mesmo que seja uma conta digital gratuita. Anote todas as entradas e saídas em uma planilha simples." }
            ],
            localStories: [
                 { name: "Ana", business: "Delícias da Vovó", photo: "https://images.unsplash.com/photo-1558522195-e1a911434645?q=80&w=800", story: "Ana começou vendendo os doces de compota que sua avó ensinou na feira de domingo. O sucesso foi tanto que hoje ela tem um pequeno café no centro de Rio Claro e fornece seus quitutes para as pousadas da região, mostrando que a tradição local é um grande negócio." },
                 { name: "Pedro", business: "Rio Claro Aventuras", photo: "https://randomuser.me/api/portraits/men/50.jpg", story: "Amante de trilhas, Pedro começou a guiar amigos para as cachoeiras de Lídice. Hoje, sua pequena empresa 'Rio Claro Aventuras' é a principal referência de ecoturismo, oferecendo roteiros seguros e experiências inesquecíveis na Mata Atlântica." }
            ],
            resources: [
                { name: "Sebrae", link: "https://sebrae.com.br/", description: "A principal referência para pequenos negócios no Brasil. Oferece cursos, consultorias e materiais gratuitos." },
                { name: "Portal do Empreendedor", link: "https://www.gov.br/empresas-e-negocios/pt-br/empreendedor", description: "O site oficial do governo para abrir, gerenciar e dar baixa no seu MEI." },
                { name: "SynkLocal - Negócios e Carreiras", link: "https://www.instagram.com/synknegociosecarreiras/", description: "Siga nosso Instagram para dicas de carreira, vagas e insights sobre empreendedorismo local." },
                { name: "Anuncie no SynkLocal", link: "https://wa.me/5524936180096", description: "Dê visibilidade ao seu novo negócio em nossa plataforma. Fale conosco para conhecer os planos." }
            ]
        },
        cvModel: `
            <div class="bg-gray-50 p-4 sm:p-6 rounded-lg border">
                <div class="text-center mb-6">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">João da Silva</h1>
                    <p>Brasileiro, Solteiro, 18 anos</p>
                    <p>Rua das Flores, 123, Centro, Rio Claro - RJ</p>
                    <p>(24) 99999-8888 | joao.silva.email@example.com</p>
                    <p><a href="https://linkedin.com/in/joaodasilva" class="text-blue-600 hover:underline">linkedin.com/in/joaodasilva</a></p>
                </div>

                <div class="mb-6">
                    <h2 class="text-lg sm:text-xl font-bold text-[var(--primary-dark)] border-b-2 border-teal-200 pb-1 mb-2">OBJETIVO</h2>
                    <p>Busco minha primeira oportunidade de emprego para desenvolver minhas habilidades, aprender na prática e contribuir de forma proativa para o crescimento da empresa, preferencialmente na área de atendimento ao público ou turismo.</p>
                </div>

                <div class="mb-6">
                    <h2 class="text-lg sm:text-xl font-bold text-[var(--primary-dark)] border-b-2 border-teal-200 pb-1 mb-2">FORMAÇÃO</h2>
                    <p><strong>Ensino Médio Completo</strong><br>
                    Colégio Estadual de Rio Claro, Conclusão em 2024</p>
                </div>

                <div class="mb-6">
                    <h2 class="text-lg sm:text-xl font-bold text-[var(--primary-dark)] border-b-2 border-teal-200 pb-1 mb-2">EXPERIÊNCIA</h2>
                    <p><strong>Voluntário em Evento (Junho/2024)</strong><br>
                    - Ajudei na organização da festa junina da comunidade, responsável pela barraca de jogos e pelo controle das fichas.</p>
                </div>

                <div class="mb-6">
                    <h2 class="text-lg sm:text-xl font-bold text-[var(--primary-dark)] border-b-2 border-teal-200 pb-1 mb-2">HABILIDADES</h2>
                    <ul class="list-disc list-inside space-y-1">
                        <li><strong>Idiomas:</strong> Inglês Básico</li>
                        <li><strong>Informática:</strong> Pacote Office (Word, Excel, PowerPoint), Canva, Redes Sociais.</li>
                        <li><strong>Competências:</strong> Proatividade, boa comunicação, organização, aprendo rápido e gosto de trabalhar em equipe.</li>
                    </ul>
                </div>
            </div>
        `
    }
};

const State = {
    chartInstance: null,
    currentCity: null,
    currentView: 'city-selection',
    previousView: null,
    currentFilters: { searchTerm: '', category: '', neighborhood: [], status: 'all' },
    foodGuideFilters: { searchTerm: '', delivery: false, acceptsReservations: false, outdoorSeating: false },
    eventFilter: 'Todos',
    countdownIntervals: [],
    tourismMap: null, // Para guardar a instância do mapa
    routingControl: null, // Para guardar a instância da rota
    tourismFilter: 'Todos', // Para o filtro de pontos turísticos
    
    clearCountdownIntervals() {
        this.countdownIntervals.forEach(clearInterval);
        this.countdownIntervals = [];
    },

    clearMapInstances() {
        if (this.tourismMap) {
            this.tourismMap.remove();
            this.tourismMap = null;
        }
        if(this.routingControl) {
            this.routingControl = null;
        }
    }
};

const App = {
    init() {
        document.addEventListener('DOMContentLoaded', () => {
            UI.renderCitySelection();
            this.navigateTo('city-selection');
            document.getElementById('mobile-menu-button').addEventListener('click', UI.toggleMobileMenu);
            window.addEventListener('scroll', UI.handleScroll);
        });
    },

    navigateTo(view, data) {
        if(State.currentView !== view) {
            State.previousView = State.currentView;
        }
        State.currentView = view;

        State.clearCountdownIntervals();
        State.clearMapInstances(); // Limpa mapas ao navegar
        UI.showView(view);
        window.scrollTo(0, 0);

        setTimeout(() => {
            switch(view) {
                case 'city-selection':
                    State.currentCity = null;
                    UI.updateHeader("SynkLocal", false);
                    UI.renderCitySelection();
                    break;
                case 'home':
                    UI.updateHeader(`Guia de ${State.currentCity}`, true);
                    UI.renderHomeContent();
                    break;
                case 'culture':
                    UI.renderCulturePage(data);
                    break;
                case 'careers':
                    UI.renderCareersPage();
                    break;
                case 'food-guide':
                    UI.renderFoodGuidePage();
                    break;
                case 'results':
                    UI.renderResults(data);
                    break;
                case 'details':
                    UI.renderDetails(data);
                    break;
                case 'events':
                    UI.renderEventsPage();
                    break;
            }
        }, 50); 
    },

    navigateBack() {
        const targetView = State.previousView || 'home';
        if (targetView === 'details') {
            this.navigateTo('home');
        } else {
            this.navigateTo(targetView);
        }
    },

    selectCity(cityName) {
        State.currentCity = cityName;
        this.navigateTo('home');
    },

    filterByCategory(categoryName) {
        if (categoryName === 'Alimentação') {
            this.navigateTo('food-guide');
            return;
        }
        State.currentFilters = { searchTerm: '', category: categoryName, neighborhood: [], status: 'all' };
        document.getElementById('search-input-results').value = '';
        const searchInput = document.getElementById('search-input-home');
        if(searchInput) searchInput.value = '';
        this.performSearch(false);
    },
    
    filterEvents(category) {
        State.eventFilter = category;
        UI.renderEventsPage();
    },
    
    filterTourismSpots(category) {
        State.tourismFilter = category;
        UI.renderCultureTourismTab(false); // Re-renderiza sem reinicializar o mapa
    },
    
    showItineraryOnMap(itineraryId) {
        const city = DB.cities.find(c => c.name === State.currentCity);
        const itinerary = city.culture.tourism.itineraries.find(i => i.id === itineraryId);
        if (!itinerary || !State.tourismMap) return;

        if (State.routingControl) {
            State.tourismMap.removeControl(State.routingControl);
        }

        const waypoints = itinerary.spots.map(spotName => {
            const spot = city.culture.tourism.spots.find(s => s.name === spotName);
            return L.latLng(spot.lat, spot.lon);
        });

        State.routingControl = L.Routing.control({
            waypoints: waypoints,
            routeWhileDragging: true,
            show: false, // Esconde o painel de direções
            addWaypoints: false, // Impede que o usuário adicione novos pontos
            lineOptions: {
                styles: [{ color: '#26A69A', opacity: 0.8, weight: 6 }]
            }
        }).addTo(State.tourismMap);

        // Foca o mapa na rota
        const bounds = L.latLngBounds(waypoints);
        State.tourismMap.fitBounds(bounds, { padding: [50, 50] });
    },

    applyFilters() {
        State.currentFilters.searchTerm = document.getElementById('search-input-results').value.toLowerCase();
        const selectedNeighborhoods = Array.from(document.querySelectorAll('.filter-neighborhood-box:checked')).map(el => el.value);
        State.currentFilters.neighborhood = selectedNeighborhoods;
        State.currentFilters.status = document.querySelector('input[name="status"]:checked').value;
        this.performSearch(false);
    },

    performSearch(fromHome = true, inputId = 'search-input-home') {
        if (fromHome) {
            State.currentFilters = { 
                searchTerm: document.getElementById(inputId).value.toLowerCase(), 
                category: '', 
                neighborhood: [], 
                status: 'all' 
            };
            if(document.getElementById('search-input-results')) {
                document.getElementById('search-input-results').value = State.currentFilters.searchTerm;
            }
        }

        const filteredCompanies = DB.companies.filter(company => {
            if (company.cidade !== State.currentCity) return false;

            const searchTerm = State.currentFilters.searchTerm.toLowerCase();
            const matchesSearchTerm = searchTerm ? 
                company.nome.toLowerCase().includes(searchTerm) || 
                company.descricao.toLowerCase().includes(searchTerm) ||
                (company.palavras_chave && company.palavras_chave.some(k => k.toLowerCase().includes(searchTerm))) : true;
            
            let matchesCategory = true; // Inicia como verdadeiro
                if (State.currentFilters.category === 'Promoções') {
                    // Se a categoria for 'Promoções', o critério é ter uma promoção
                    matchesCategory = !!company.promotion;
                } else if (State.currentFilters.category) {
                    // Para todas as outras categorias, usa a lógica original
                    matchesCategory = company.categorias.includes(State.currentFilters.category);
                }
            const matchesNeighborhood = State.currentFilters.neighborhood.length > 0 ? State.currentFilters.neighborhood.includes(company.endereco.bairro) : true;
            const matchesStatus = State.currentFilters.status === 'open' ? Utils.isCompanyOpen(company) : true;

            return matchesSearchTerm && matchesCategory && matchesNeighborhood && matchesStatus;
        });

        this.navigateTo('results', filteredCompanies);
    },

    applyFoodFilters() {
        State.foodGuideFilters.searchTerm = document.getElementById('food-search-input').value.toLowerCase();
        State.foodGuideFilters.delivery = document.getElementById('food-filter-delivery').checked;
        State.foodGuideFilters.acceptsReservations = document.getElementById('food-filter-reservations').checked;
        State.foodGuideFilters.outdoorSeating = document.getElementById('food-filter-outdoor').checked;
        
        UI.renderFoodGuidePage();
    },

    openQuoteModal(companyId) {
        const company = DB.companies.find(c => c.id === companyId);
        document.getElementById('modal-company-name').textContent = company.nome;
        UI.openModal('quote-modal');
    },

    sendQuote() {
        UI.showQuoteSuccess();
    }
};

const UI = {
    showView(viewId) {
        document.querySelectorAll('.view').forEach(v => {
            v.classList.add('hidden-view');
            v.classList.remove('opacity-100', 'translate-y-0');
        });
        const targetView = document.getElementById(`${viewId}-view`);
        if (targetView) {
            targetView.classList.remove('hidden-view');
            setTimeout(() => {
                targetView.classList.add('opacity-100');
                targetView.style.transform = 'translateY(0)';
            }, 10);
        }
    },

    updateHeader(title, showNav) {
        document.getElementById('main-title').textContent = title;
        const navItems = ['nav-home', 'nav-culture', 'nav-events', 'nav-careers', 'change-city-btn'];
        navItems.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.classList.toggle('hidden', !showNav);
        });
        document.getElementById('mobile-menu-button').classList.toggle('hidden', !showNav);
    },

    toggleMobileMenu() {
        document.getElementById('mobile-menu').classList.toggle('hidden');
    },
    
    showSkeleton(container, cardHTML, count) {
        let skeletons = '';
        for (let i = 0; i < count; i++) {
            skeletons += cardHTML;
        }
        container.innerHTML = skeletons;
    },

    renderCitySelection() {
        const grid = document.getElementById('city-grid');
        grid.innerHTML = DB.cities.map(city => `
            <div onclick="App.selectCity('${city.name}')" class="bg-white rounded-3xl shadow-lg shadow-teal-100/50 overflow-hidden cursor-pointer group transform hover:-translate-y-2 transition-all duration-300 hover:shadow-2xl hover:shadow-teal-200/60">
                <div class="h-56 overflow-hidden">
                    <img src="${city.image}" alt="Imagem de ${city.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=Imagem+Indisponível';">
                </div>
                <div class="p-6">
                    <h3 class="text-xl sm:text-2xl font-bold text-gray-800 group-hover:text-[var(--primary-dark)] transition-colors duration-300">${city.name}</h3>
                </div>
            </div>
        `).join('');
    },

    renderHomeContent() {
        const container = document.getElementById('home-view');
        container.innerHTML = `
            <section id="welcome-section" class="mb-12"></section>
            
            <section id="home-search-section" class="text-center mb-12 p-6 md:p-10 bg-white rounded-3xl shadow-xl shadow-teal-100/50">
                <h2 id="home-title" class="text-2xl sm:text-3xl md:text-4xl font-bold mb-3 tracking-tight">O que você procura em ${State.currentCity}?</h2>
                <p class="text-gray-500 max-w-2xl mx-auto mb-8 text-sm sm:text-base">Explore o comércio local, descubra serviços incríveis e fique por dentro dos melhores eventos.</p>
                <div class="max-w-xl mx-auto flex flex-col sm:flex-row shadow-lg shadow-teal-200/50 rounded-full">
                    <input id="search-input-home" type="text" placeholder="Ex: restaurante, pousada, cachoeira..." class="w-full p-3 sm:p-4 border border-gray-200 rounded-full sm:rounded-none sm:rounded-l-full focus:ring-2 focus:ring-[var(--primary)] focus:outline-none transition-shadow mb-2 sm:mb-0">
                    <button onclick="App.performSearch(true, 'search-input-home')" class="w-full sm:w-auto bg-[var(--primary)] text-white px-6 sm:px-8 py-3 sm:py-4 rounded-full sm:rounded-none sm:rounded-r-full font-semibold hover:bg-[var(--primary-dark)] transition-colors transform active:scale-95">Buscar</button>
                </div>
            </section>

            <section id="promotions-section" class="mb-12"></section>

            <section id="categories-section" class="mb-12">
                <h3 class="text-2xl font-bold mb-6 tracking-tight">Navegue por Categorias 🧭</h3>
                <div id="categories-grid" class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-5"></div>
            </section>

            <section id="events-home-section" class="mb-12">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold tracking-tight">Próximos Eventos 🥳</h3>
                    <a href="#" onclick="App.navigateTo('events')" class="text-[var(--primary-dark)] font-semibold hover:underline text-sm sm:text-base">Ver Todos →</a>
                </div>
                <div id="events-home-grid" class="flex overflow-x-auto space-x-6 pb-4 scroll-container -m-2 p-2"></div>
            </section>

            <section id="featured-section" class="mb-12">
                <h3 class="text-2xl font-bold mb-6 tracking-tight">Empresas em Destaque ⭐</h3>
                <div id="featured-grid" class="flex overflow-x-auto space-x-6 pb-4 scroll-container -m-2 p-2"></div>
            </section>

            <section id="new-section">
                <h3 class="text-2xl font-bold mb-6 tracking-tight">Novas Empresas 🌱</h3>
                <div id="new-grid" class="flex overflow-x-auto space-x-6 pb-4 scroll-container -m-2 p-2"></div>
            </section>
        `;
        this.renderWelcomeSection();
        this.renderPromotions();
        this.renderCategories();
        this.renderHomeEvents();
        this.renderFeatured();
        this.renderNew();
    },

    renderWelcomeSection() {
        const container = document.getElementById('welcome-section');
        if (!container) return;
        container.innerHTML = `
            <section class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                <div class="bg-white rounded-3xl shadow-lg p-6 sm:p-8 text-center flex flex-col items-center transform hover:-translate-y-2 transition-all duration-300 hover:shadow-2xl cursor-pointer" onclick="document.getElementById('home-search-section').scrollIntoView({ behavior: 'smooth' });">
                    <div class="text-5xl mb-4">🏠</div>
                    <h3 class="text-xl sm:text-2xl font-bold text-gray-800 mb-3">Sou morador</h3>
                    <p class="text-gray-600 mb-6 flex-grow text-sm sm:text-base">Encontre tudo o que precisa, veja as novidades e aproveite as melhores promoções da sua cidade.</p>
                    <span class="mt-auto bg-teal-100 text-teal-800 px-6 py-2 rounded-full font-bold text-sm sm:text-base">Explorar o Comércio</span>
                </div>
                <div class="bg-white rounded-3xl shadow-lg p-6 sm:p-8 text-center flex flex-col items-center transform hover:-translate-y-2 transition-all duration-300 hover:shadow-2xl cursor-pointer" onclick="App.navigateTo('culture', { tab: 'tourism' })">
                    <div class="text-5xl mb-4">🧭</div>
                    <h3 class="text-xl sm:text-2xl font-bold text-gray-800 mb-3">Sou visitante</h3>
                    <p class="text-gray-600 mb-6 flex-grow text-sm sm:text-base">Descubra as fazendas históricas, a cultura e tudo que faz de ${State.currentCity} um lugar encantador.</p>
                    <span class="mt-auto bg-amber-100 text-amber-800 px-6 py-2 rounded-full font-bold text-sm sm:text-base">Descobrir a Região</span>
                </div>
            </section>
        `;
    },

    renderPromotions() {
        const section = document.getElementById('promotions-section');
        const companiesWithPromo = DB.companies.filter(c => c.cidade === State.currentCity && c.promotion);

        if (companiesWithPromo.length === 0) {
            section.innerHTML = '';
            section.classList.add('hidden');
            return;
        }
        
        section.classList.remove('hidden');
        section.innerHTML = `
            <h3 class="text-2xl font-bold mb-6 tracking-tight">Promoções Imperdíveis 🔥</h3>
            <div class="flex overflow-x-auto space-x-6 pb-4 scroll-container -m-2 p-2">
                ${companiesWithPromo.map(this._createPromotionCard).join('')}
            </div>
        `;
    },

    _createPromotionCard(company) {
        const promo = company.promotion;
        return `
        <div onclick="App.navigateTo('details', '${company.id}')" class="flex-shrink-0 w-80 md:w-96 bg-gradient-to-br from-amber-400 to-orange-500 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 text-white overflow-hidden group cursor-pointer">
            <div class="p-6 flex flex-col h-full">
                <div class="flex items-start justify-between">
                    <div class="flex items-center">
                        <img src="${company.logotipo}" alt="Logo de ${company.nome}" class="w-12 h-12 rounded-full border-2 border-white/50 object-cover mr-3">
                        <div>
                            <h4 class="font-bold">${company.nome}</h4>
                            <p class="text-xs opacity-80">${company.categorias[0]}</p>
                        </div>
                    </div>
                    <span class="bg-white/20 text-white text-xs font-bold px-2 py-1 rounded-full uppercase">${promo.tag}</span>
                </div>
                <div class="my-4 flex-grow">
                    <h5 class="text-xl sm:text-2xl font-extrabold tracking-tight">${promo.title}</h5>
                    <p class="text-sm opacity-90 mt-2">${promo.description}</p>
                </div>
                <div class="mt-auto text-center font-bold text-white/80 group-hover:text-white transition-colors">
                    Ver Oferta ›
                </div>
            </div>
        </div>
        `;
    },

    renderCategories(gridId = 'categories-grid') {
        const grid = document.getElementById(gridId);
        if (!grid) return;
        grid.innerHTML = DB.categories.map(cat => `
            <div onclick="App.filterByCategory('${cat.name}')" class="bg-white p-3 sm:p-4 rounded-2xl shadow-md shadow-teal-100/30 text-center cursor-pointer hover:shadow-xl hover:shadow-teal-200/50 hover:-translate-y-1 transition-all duration-300 group">
                <div class="bg-teal-50 text-2xl sm:text-3xl w-14 h-14 sm:w-16 sm:h-16 rounded-full flex items-center justify-center mx-auto group-hover:bg-teal-100 transition-colors duration-300">${cat.icon}</div>
                <h4 class="mt-3 sm:mt-4 font-semibold text-xs sm:text-sm md:text-base text-gray-700 group-hover:text-[var(--primary-dark)]">${cat.name}</h4>
            </div>
        `).join('');
    },

    _createCompanyCard(company) {
        const verifiedIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1.5 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zM9 12a1 1 0 112 0 1 1 0 01-2 0zm-1-3a1 1 0 00-1 1v1a1 1 0 102 0v-1a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>`;

        return `
        <div class="bg-white rounded-2xl shadow-lg shadow-teal-100/50 overflow-hidden flex flex-col h-full group transition-all duration-300 hover:shadow-2xl hover:shadow-teal-200/60 hover:-translate-y-2">
            <div class="relative overflow-hidden cursor-pointer" onclick="App.navigateTo('details', '${company.id}')">
                <img src="${company.galeria_fotos[0]}" alt="${company.nome}" class="w-full h-48 object-cover group-hover:scale-110 transition-transform duration-500" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=Imagem+Indisponível';">
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                ${Utils.getOpenStatusBadge(company)}
                <div class="absolute bottom-2 left-4 text-white">
                    <h4 class="font-bold text-lg flex items-center drop-shadow-md">${company.nome} ${company.verificado ? verifiedIcon : ''}</h4>
                    <p class="text-teal-200 text-sm drop-shadow-md">${company.categorias[0]}</p>
                </div>
            </div>
            <div class="p-4 flex flex-col flex-grow">
                <p class="text-gray-500 text-sm mb-4"><span class="font-semibold">📍</span> ${company.endereco.bairro}, ${company.endereco.cidade}</p>
                <div class="flex items-center mt-auto pt-4 border-t border-gray-100">
                    ${Utils.renderStars(Utils.calculateAverageRating(company.avaliacoes))}
                    <span class="text-xs text-gray-400 ml-2">(${company.avaliacoes.length} aval.)</span>
                    <button onclick="App.navigateTo('details', '${company.id}')" class="ml-auto bg-teal-50 text-teal-700 px-3 py-1.5 rounded-full font-semibold hover:bg-teal-100 hover:text-teal-800 transition-all text-sm transform active:scale-95">Detalhes</button>
                </div>
            </div>
        </div>
        `;
    },
    
    _createCarouselCard(company) {
        const verifiedIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1.5 text-blue-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zM9 12a1 1 0 112 0 1 1 0 01-2 0zm-1-3a1 1 0 00-1 1v1a1 1 0 102 0v-1a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>`;
        return `
        <div class="flex-shrink-0 w-64 sm:w-72 bg-white rounded-2xl shadow-md shadow-teal-100/40 overflow-hidden transform hover:scale-105 transition-transform group duration-300 hover:shadow-xl hover:shadow-teal-200/50">
            <div onclick="App.navigateTo('details', '${company.id}')" class="cursor-pointer relative">
                <div class="overflow-hidden h-36">
                    <img src="${company.galeria_fotos[0]}" alt="${company.nome}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=Imagem+Indisponível';">
                    ${Utils.getOpenStatusBadge(company, 'absolute top-2 right-2')}
                </div>
                <div class="p-4">
                    <h4 class="font-bold text-md truncate flex items-center">${company.nome} ${company.verificado ? verifiedIcon : ''}</h4>
                    <p class="text-teal-600 text-sm truncate">${company.categorias[1] || company.categorias[0]}</p>
                    <p class="text-gray-500 text-xs truncate mt-1">📍 ${company.endereco.bairro}, ${company.endereco.cidade}</p>
                </div>
            </div>
        </div>
        `;
    },
    
    renderFeatured(gridId = 'featured-grid') {
        const grid = document.getElementById(gridId);
        if (!grid) return;
        const companies = DB.companies.filter(c => c.plano === 'destaque' && c.cidade === State.currentCity);
        grid.innerHTML = companies.length > 0 ? companies.map(c => this._createCarouselCard(c)).join('') : `<p class="text-gray-500 pl-2">Nenhuma empresa em destaque no momento.</p>`;
    },

    renderNew(gridId = 'new-grid') {
        const grid = document.getElementById(gridId);
        if (!grid) return;
        const companies = [...DB.companies].filter(c => c.cidade === State.currentCity).sort((a, b) => new Date(b.data_cadastro) - new Date(a.data_cadastro)).slice(0, 5);
        grid.innerHTML = companies.length > 0 ? companies.map(c => this._createCarouselCard(c)).join('') : `<p class="text-gray-500 pl-2">Nenhuma nova empresa cadastrada.</p>`;
    },
    
    _createEventCard(event) {
        const now = new Date();
        const startDate = new Date(event.data_inicio);
        const endDate = new Date(event.data_fim);
        const isHappening = now >= startDate && now <= endDate;
        const isUpcoming = now < startDate;

        let statusHTML = '';
        if (isHappening) {
            statusHTML = `<div class="absolute top-3 left-3 bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full animate-pulse shadow-lg">AO VIVO</div>`;
        } else if (isUpcoming) {
            statusHTML = `<div id="countdown-${event.id}" class="absolute bottom-0 left-0 right-0 bg-black/60 text-white text-center p-2 text-sm font-semibold backdrop-blur-sm"></div>`;
        }

        const formattedDate = `${startDate.toLocaleDateString('pt-BR', { day: '2-digit', month: 'short' })} - ${startDate.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}`;
        const priceColor = event.preco && (event.preco.toLowerCase() === 'gratuito' || event.preco.toLowerCase() === 'entrada franca') ? 'text-green-600' : 'text-amber-600';

        return `
        <div class="bg-white rounded-2xl shadow-lg shadow-teal-100/50 overflow-hidden flex flex-col h-full group transform hover:-translate-y-2 transition-all duration-300 hover:shadow-2xl hover:shadow-teal-200/60">
            <div class="relative">
                <img src="${event.imagem}" alt="${event.nome}" class="w-full h-56 object-cover group-hover:scale-110 transition-transform duration-500" onerror="this.onerror=null;this.src='https://placehold.co/800x600/cccccc/ffffff?text=Evento';">
                <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent z-10"></div>
                ${statusHTML}
                <div class="absolute top-3 right-3 bg-white/90 text-teal-800 text-xs font-bold px-3 py-1.5 rounded-full backdrop-blur-sm shadow-md">${event.categoria}</div>
            </div>
            <div class="p-5 flex flex-col flex-grow">
                <p class="text-sm font-bold text-teal-500 mb-1">${formattedDate}</p>
                <h4 class="font-extrabold text-xl text-[var(--text-main)] mb-2 tracking-tight">${event.nome}</h4>
                <p class="text-gray-600 text-sm mb-4 flex-grow">${event.descricao}</p>
                
                <div class="space-y-3 text-sm text-gray-700 mt-auto pt-4 border-t border-gray-100">
                    <div class="flex items-center"><span class="w-5 mr-2 text-center text-gray-500"><i class="fa-solid fa-user-tie"></i></span><strong>Organizador:</strong><span class="ml-2">${event.organizador || 'Não informado'}</span></div>
                    <div class="flex items-center"><span class="w-5 mr-2 text-center text-gray-500"><i class="fa-solid fa-map-marker-alt"></i></span><strong>Local:</strong><span class="ml-2">${event.local}</span></div>
                    <div class="flex items-center"><span class="w-5 mr-2 text-center text-gray-500"><i class="fa-solid fa-dollar-sign"></i></span><strong>Preço:</strong><span class="ml-2 font-bold ${priceColor}">${event.preco || 'Consultar'}</span></div>
                    <div class="flex items-center"><span class="w-5 mr-2 text-center text-gray-500"><i class="fa-solid fa-bullseye"></i></span><strong>Público:</strong><span class="ml-2">${event.publico_alvo || 'Todos'}</span></div>
                </div>

                ${event.tags && event.tags.length > 0 ? `
                <div class="mt-4 pt-3 border-t border-gray-100">
                    <div class="flex flex-wrap gap-2">
                        ${event.tags.map(tag => `<span class="bg-gray-200 text-gray-700 text-xs font-semibold px-2 py-1 rounded-full">${tag}</span>`).join('')}
                    </div>
                </div>
                ` : ''}
            </div>
        </div>
        `;
    },
    
    renderHomeEvents(gridId = 'events-home-grid') {
        const grid = document.getElementById(gridId);
        if (!grid) return;
        const upcomingEvents = [...DB.events].filter(e => e.cidade === State.currentCity && new Date(e.data_fim) > new Date()).sort((a, b) => new Date(a.data_inicio) - new Date(b.data_inicio)).slice(0, 5);
        grid.innerHTML = upcomingEvents.length > 0 ? upcomingEvents.map(event => `<div class="flex-shrink-0 w-80">${this._createEventCard(event)}</div>`).join('') : `<p class="text-gray-500 pl-2">Nenhum evento programado.</p>`;
        this.startCountdowns();
    },

    renderEventsPage() {
        document.getElementById('events-title').textContent = `Eventos em ${State.currentCity}`;
        
        const allEventsInCity = DB.events.filter(e => e.cidade === State.currentCity);
        const eventCategories = ['Todos', ...new Set(allEventsInCity.map(e => e.categoria))];
        
        const filtersContainer = document.getElementById('event-filters');
        filtersContainer.innerHTML = eventCategories.map(cat => `
            <button onclick="App.filterEvents('${cat}')" class="filter-btn px-4 py-2 text-sm font-semibold rounded-full whitespace-nowrap ${State.eventFilter === cat ? 'active bg-white border-2' : 'bg-white text-gray-700 hover:bg-gray-100 shadow-sm hover:shadow-md border-2 border-transparent'}">
                ${cat}
            </button>
        `).join('');

        const now = new Date();
        const filteredEvents = State.eventFilter === 'Todos' 
            ? allEventsInCity 
            : allEventsInCity.filter(e => e.categoria === State.eventFilter);
            
        const happeningNowEvents = filteredEvents.filter(e => now >= new Date(e.data_inicio) && now <= new Date(e.data_fim)).sort((a, b) => new Date(a.data_inicio) - new Date(b.data_inicio));
        const upcomingEvents = filteredEvents.filter(e => now < new Date(e.data_inicio)).sort((a, b) => new Date(a.data_inicio) - new Date(b.data_inicio));

        const happeningNowContainer = document.getElementById('happening-now-section');
        const upcomingEventsContainer = document.getElementById('upcoming-events-section');
        const noEventsMsg = document.getElementById('no-events');

        if (happeningNowEvents.length > 0) {
            happeningNowContainer.innerHTML = `
                <h3 class="text-2xl font-bold mb-6 mt-8 border-l-4 border-red-400 pl-4 tracking-tight">Acontecendo Agora</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    ${happeningNowEvents.map(event => this._createEventCard(event)).join('')}
                </div>
            `;
        } else {
            happeningNowContainer.innerHTML = '';
        }

        if (upcomingEvents.length > 0) {
            upcomingEventsContainer.innerHTML = `
                <h3 class="text-2xl font-bold mb-6 mt-8 border-l-4 border-teal-400 pl-4 tracking-tight">Próximos Eventos</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    ${upcomingEvents.map(event => this._createEventCard(event)).join('')}
                </div>
            `;
        } else {
            upcomingEventsContainer.innerHTML = '';
        }
        
        noEventsMsg.classList.toggle('hidden', happeningNowEvents.length > 0 || upcomingEvents.length > 0);

        this.startCountdowns();
    },
    
    startCountdowns() {
        State.clearCountdownIntervals();
        const upcomingEvents = DB.events.filter(e => new Date(e.data_inicio) > new Date());
        upcomingEvents.forEach(event => {
            const countdownElement = document.getElementById(`countdown-${event.id}`);
            if (countdownElement) {
                const interval = setInterval(() => {
                    const countdown = Utils.formatCountdown(event.data_inicio);
                    if (countdown) {
                        countdownElement.innerHTML = `Começa em: ${countdown}`;
                    } else {
                        countdownElement.parentElement.innerHTML = `<div class="absolute top-3 left-3 bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full animate-pulse shadow-lg">AO VIVO</div>` + countdownElement.parentElement.innerHTML;
                        countdownElement.remove();
                        clearInterval(interval);
                    }
                }, 1000);
                State.countdownIntervals.push(interval);
            }
        });
    },
    
    renderFilters() {
        const container = document.getElementById('filter-neighborhood');
        const neighborhoods = [...new Set(DB.companies.filter(c => c.cidade === State.currentCity).map(c => c.endereco.bairro))];
        container.innerHTML = neighborhoods.map(n => `
            <div class="flex items-center">
                <input type="checkbox" id="n-${n.replace(/\s+/g, '')}" value="${n}" class="h-4 w-4 text-teal-500 border-gray-300 rounded focus:ring-teal-400 filter-neighborhood-box">
                <label for="n-${n.replace(/\s+/g, '')}" class="ml-2 text-sm">${n}</label>
            </div>
        `).join('') || '<p class="text-xs text-gray-500">Nenhum bairro para filtrar.</p>';
    },
    
    renderResults(companies) {
        const grid = document.getElementById('results-grid');
        const noResultsMsg = document.getElementById('no-results');
        const title = document.getElementById('results-title');

        if (State.currentFilters.category) {
            title.textContent = `Resultados para "${State.currentFilters.category}"`;
        } else if(State.currentFilters.searchTerm) {
             title.textContent = `Resultados para "${State.currentFilters.searchTerm}"`;
        } else {
             title.textContent = `Todos os resultados em ${State.currentCity}`;
        }

        this.renderFilters();

        if (companies.length > 0) {
            grid.innerHTML = companies.map(this._createCompanyCard).join('');
            grid.classList.remove('hidden');
            noResultsMsg.classList.add('hidden');
        } else {
            grid.innerHTML = '';
            grid.classList.add('hidden');
            noResultsMsg.classList.remove('hidden');
        }
    },
    
    renderDetails(companyId) {
        const container = document.getElementById('details-view');
        const skeletonHTML = `<div class="w-full h-96 skeleton-card"></div>`;
        this.showSkeleton(container, skeletonHTML, 1);

        setTimeout(() => {
            const company = DB.companies.find(c => c.id === companyId);
            if (!company) {
                container.innerHTML = `<p>Empresa não encontrada.</p><button onclick="App.navigateTo('home')" class="mt-4 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300">Voltar</button>`;
                return;
            }

            const avgRating = Utils.calculateAverageRating(company.avaliacoes);
            const companyEvent = DB.events.find(event => event.local === company.nome && event.cidade === company.cidade && new Date(event.data_inicio) > new Date());
            const verifiedIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 ml-2 text-blue-500" viewBox="0 0 20 20" fill="currentColor" title="Verificado"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zM9 12a1 1 0 112 0 1 1 0 01-2 0zm-1-3a1 1 0 00-1 1v1a1 1 0 102 0v-1a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>`;
            
            let sobreNosHTML = '';

            if (company.sobreNos) {
                const backgroundImageUrl = company.galeria_fotos[1] || company.galeria_fotos[0];

                sobreNosHTML = `
                <div class="space-y-12 md:space-y-16">
                    <section class="relative rounded-3xl overflow-hidden text-white p-8 md:p-12 flex items-center justify-center text-center h-64 sm:h-80 bg-fixed" style="background-image: url('${backgroundImageUrl}'); background-size: cover; background-position: center;">
                        <div class="absolute inset-0 bg-gray-900/50 mix-blend-multiply"></div>
                        <div class="relative z-10">
                            <h3 class="text-3xl md:text-5xl font-extrabold tracking-tight drop-shadow-lg">A Jornada da ${company.nome}</h3>
                            <p class="mt-4 max-w-2xl mx-auto text-base sm:text-lg md:text-xl opacity-90 drop-shadow-md">${company.sobreNos.historia}</p>
                        </div>
                    </section>
                    
                    <section class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center">
                        <div class="md:col-span-1 flex justify-center">
                             <img src="${company.sobreNos.fundador.foto}" alt="Foto de ${company.sobreNos.fundador.nome}" class="w-48 h-48 rounded-full shadow-2xl border-4 border-white object-cover">
                        </div>
                        <div class="md:col-span-2 bg-teal-50/40 p-6 rounded-2xl text-center md:text-left">
                            <h4 class="text-2xl font-bold text-gray-800">${company.sobreNos.fundador.nome}</h4>
                            <p class="text-sm text-gray-500 mb-3">Fundador(a) & Visionário(a)</p>
                            <p class="text-gray-700 text-lg italic border-l-4 md:border-l-4 border-teal-400 pl-4">"${company.sobreNos.fundador.citacao}"</p>
                        </div>
                    </section>

                    <section>
                        <h3 class="text-2xl md:text-3xl font-bold mb-8 text-center tracking-tight">Nosso DNA: Os Pilares do Negócio</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            ${company.sobreNos.valores.map(valor => `
                                <div class="jornada-valor-card bg-teal-50/30 p-6 rounded-2xl border border-teal-100 text-center">
                                    <div class="bg-white text-teal-600 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 shadow-md">
                                        <i class="${valor.icone} text-2xl"></i>
                                    </div>
                                    <h5 class="font-bold text-lg text-gray-800">${valor.titulo}</h5>
                                    <p class="text-sm text-gray-600 mt-2">${valor.descricao}</p>
                                </div>
                            `).join('')}
                        </div>
                    </section>

                    ${company.sobreNos.teamGallery && company.sobreNos.teamGallery.length > 0 ? `
                    <section>
                        <h3 class="text-2xl md:text-3xl font-bold mb-8 text-center tracking-tight">As Pessoas Por Trás do Sucesso</h3>
                        <div class="team-mosaic grid grid-cols-2 md:grid-cols-4 gap-4">
                        ${(company.sobreNos.teamGallery || []).map((member, index) => `
                            <a href="#" class="block rounded-2xl overflow-hidden shadow-lg ${index === 0 ? 'col-span-2 row-span-2' : ''}">
                                <img src="${member.img}" alt="Foto de ${member.name}" class="w-full h-full object-cover">
                            </a>
                        `).join('')}
                        </div>
                    </section>`: ''}
                </div>
                `;
            } else {
                sobreNosHTML = `<h3 class="text-xl font-bold mb-4 border-b border-teal-100 pb-2">Sobre</h3>
                                        <p class="text-gray-700 leading-relaxed mb-8 prose">${company.descricao}</p>`;
            }

            container.innerHTML = `
                <button onclick="App.navigateBack()" class="bg-gray-100 text-gray-800 px-5 py-2.5 rounded-full mb-8 hover:bg-gray-200 transition-all shadow active:scale-95 text-sm font-semibold">← Voltar</button>
                <div class="flex flex-col md:flex-row md:space-x-10 items-center">
                    <div class="md:w-1/3 mb-6 md:mb-0 text-center flex-shrink-0">
                        <img src="${company.logotipo}" alt="Logotipo de ${company.nome}" class="w-32 h-32 sm:w-40 sm:h-40 rounded-full mx-auto shadow-2xl shadow-teal-200/80 border-4 border-white -mt-20 md:-mt-24">
                    </div>
                    <div class="md:w-2/3 text-center md:text-left">
                        <div class="flex flex-wrap gap-2 mb-4 justify-center md:justify-start">
                            ${company.categorias.map(cat => `<span class="bg-teal-100 text-teal-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">${cat}</span>`).join('')}
                        </div>
                        <h2 class="text-3xl sm:text-4xl font-extrabold mb-2 flex items-center justify-center md:justify-start tracking-tight">${company.nome} ${company.verificado ? verifiedIcon : ''}</h2>
                        <div class="flex items-center mb-4 justify-center md:justify-start">
                            ${Utils.renderStars(avgRating)}
                            <span class="text-sm text-gray-500 ml-2">${avgRating.toFixed(1)} de 5 (${company.avaliacoes.length} avaliações)</span>
                        </div>
                    </div>
                </div>
                
                ${companyEvent ? `
                <div class="my-8 p-5 rounded-2xl bg-gradient-to-r from-blue-400 to-teal-400 text-white cursor-pointer shadow-lg hover:shadow-xl hover:scale-[1.02] transition-all duration-300" onclick="App.navigateTo('events')">
                    <h3 class="text-xl font-bold mb-2">🎉 Próximo Evento Aqui!</h3>
                    <p>${companyEvent.nome} em ${new Date(companyEvent.data_inicio).toLocaleDateString('pt-BR')}. Clique para ver mais!</p>
                </div>
                ` : ''}

                <div class="mt-10 grid grid-cols-1 lg:grid-cols-3 gap-10">
                    <div class="lg:col-span-2">
                        ${sobreNosHTML}

                        ${company.videoUrl ? `
                        <h3 class="text-xl font-bold mb-4 border-b border-teal-100 pb-2 mt-12">Apresentação</h3>
                        <div class="aspect-w-16 aspect-h-9 mb-8 rounded-2xl overflow-hidden shadow-lg bg-black">
                            <iframe class="w-full h-full" src="${company.videoUrl.replace('watch?v=', 'embed/')}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                        ` : ''}
                        
                        ${company.destaques ? `
                        <h3 class="text-xl font-bold mb-4 border-b border-teal-100 pb-2 mt-12">Destaques</h3>
                        <ul class="list-none space-y-3 mb-8">
                            ${company.destaques.map(d => `<li class="flex items-start"><span class="text-green-500 mr-3 mt-1">✔</span><span>${d}</span></li>`).join('')}
                        </ul>
                        ` : ''}

                        ${company.servicosProdutos && company.servicosProdutos.length > 0 ? `
                        <h3 class="text-xl font-bold mb-4 border-b border-teal-100 pb-2 mt-12">Serviços e Produtos</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8">
                            ${company.servicosProdutos.map(item => `
                                <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6 border border-gray-100 hover:shadow-xl hover:border-teal-200 transition-all duration-300 transform hover:-translate-y-1">
                                    <div class="flex flex-col sm:flex-row justify-between items-start gap-2">
                                        <h4 class="font-bold text-lg text-gray-800">${item.nome}</h4>
                                        <span class="flex-shrink-0 text-sm font-bold text-teal-700 bg-teal-100 px-3 py-1 rounded-full mt-2 sm:mt-0">${item.preco}</span>
                                    </div>
                                    <p class="text-gray-600 leading-relaxed mt-2">${item.descricao}</p>
                                </div>
                            `).join('')}
                        </div>
                        ` : ''}

                        <h3 class="text-xl font-bold mb-4 border-b border-teal-100 pb-2 mt-12">Galeria de Fotos</h3>
                        <div class="mb-8">
                            <div class="mb-4 rounded-2xl overflow-hidden shadow-xl shadow-teal-100/50">
                                <img id="gallery-main-image" src="${company.galeria_fotos[0]}" alt="Foto principal de ${company.nome}" class="w-full h-64 md:h-96 object-cover transition-opacity duration-300" onerror="this.onerror=null;this.src='https://placehold.co/800x600/cccccc/ffffff?text=Imagem+Indisponível';">
                            </div>
                            <div id="gallery-thumbnails" class="flex overflow-x-auto space-x-3 pb-2 scroll-container">
                                ${company.galeria_fotos.map((foto, index) => `
                                    <img src="${foto}" 
                                         alt="Thumbnail ${index + 1} de ${company.nome}" 
                                         class="w-20 h-20 sm:w-24 sm:h-24 object-cover rounded-xl cursor-pointer border-4 ${index === 0 ? 'border-teal-500' : 'border-transparent'} hover:border-teal-400 transition-all duration-200"
                                         onclick="UI.updateMainGalleryImage(this)"
                                         onerror="this.onerror=null;this.style.display='none';">
                                `).join('')}
                            </div>
                        </div>

                        <h3 class="text-xl font-bold mb-4 border-b border-teal-100 pb-2 mt-12">Opinião dos Clientes</h3>
                        <div class="relative w-full max-w-lg mx-auto h-64 mb-8"><canvas id="reviewsChart"></canvas></div>
                        <div class="space-y-4">
                            ${company.avaliacoes.map(review => `
                            <div class="bg-teal-50/50 p-4 rounded-xl border border-teal-100">
                                <div class="flex items-center mb-1">
                                    ${Utils.renderStars(review.nota)}
                                    <p class="ml-3 font-bold">${review.usuario}</p>
                                </div>
                                <p class="text-gray-700 italic">"${review.comentario}"</p>
                            </div>
                            `).join('')}
                        </div>
                        
                        <div id="recommendations" class="mt-12"></div>
                    </div>

                    <div class="lg:col-span-1">
                         <div class="bg-teal-50/60 p-4 sm:p-6 rounded-2xl lg:sticky top-28 border border-teal-100">
                            <h3 class="text-xl font-bold mb-4 tracking-tight">Informações</h3>
                            <div class="space-y-4 text-sm">
                                <p><strong>📍 Endereço:</strong><br>${company.endereco.rua}, ${company.endereco.bairro}</p>
                                <p><strong>⏰ Horário Hoje:</strong><br><span class="${Utils.isCompanyOpen(company) ? 'text-green-600 font-bold' : 'text-red-600 font-bold'}">${Utils.getTodaysHours(company)}</span></p>
                                <div class="space-y-3 pt-4 border-t mt-4 border-teal-200/50">
                                     <a href="https://wa.me/${company.contato.whatsapp}" target="_blank" class="flex items-center justify-center w-full bg-green-500 text-white px-4 py-3 rounded-xl font-semibold hover:bg-green-600 transition-all transform active:scale-95">💬 WhatsApp</a>
                                     <button onclick="App.openQuoteModal('${company.id}')" class="flex items-center justify-center w-full bg-blue-500 text-white px-4 py-3 rounded-xl font-semibold hover:bg-blue-600 transition-all transform active:scale-95">✉️ Pedir Orçamento</button>
                                     ${company.contato.website ? `<a href="${company.contato.website}" target="_blank" class="flex items-center justify-center w-full bg-gray-600 text-white px-4 py-3 rounded-xl font-semibold hover:bg-gray-700 transition-all transform active:scale-95">🌐 Website</a>` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            this.renderReviewsChart(company.avaliacoes);
            this.renderRecommendations(company);
        }, 500);
    },
    
    updateMainGalleryImage(clickedThumbnail) {
        const detailsMainImage = document.getElementById('gallery-main-image');
        const spotCard = clickedThumbnail.closest('.tourist-spot-card');

        let mainImage;
        if (spotCard) {
            mainImage = spotCard.querySelector('.gallery-main-image');
        } else if(detailsMainImage) {
            mainImage = detailsMainImage;
        } else {
            return;
        }
        
        const newSrc = clickedThumbnail.src;
        
        const thumbnailsContainer = clickedThumbnail.parentElement;
        thumbnailsContainer.querySelectorAll('img').forEach(thumb => {
            thumb.classList.remove('border-teal-500');
            thumb.classList.add('border-transparent');
        });
        clickedThumbnail.classList.remove('border-transparent');
        clickedThumbnail.classList.add('border-teal-500');

        mainImage.classList.add('opacity-50');
        setTimeout(() => {
            mainImage.src = newSrc;
            mainImage.classList.remove('opacity-50');
        }, 300);
    },

    renderRecommendations(currentCompany) {
        const container = document.getElementById('recommendations');
        const recommendations = DB.companies.filter(c => 
            c.id !== currentCompany.id && 
            c.cidade === currentCompany.cidade &&
            c.categorias.some(cat => currentCompany.categorias.includes(cat))
        ).slice(0, 2);

        if(recommendations.length > 0) {
            container.innerHTML = `
                <h3 class="text-xl font-bold mt-12 mb-4 border-b border-teal-100 pb-2">Você também pode gostar</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    ${recommendations.map(this._createCompanyCard).join('')}
                </div>
            `;
        } else {
            container.innerHTML = '';
        }
    },

    renderCulturePage(data) {
        const container = document.getElementById('culture-content');
        const city = DB.cities.find(c => c.name === State.currentCity);

        if (!city || !city.culture) {
            container.innerHTML = `<div class="bg-white rounded-3xl shadow-lg p-10 text-center"><h2 class="text-3xl font-bold mb-4">Cultura de ${State.currentCity}</h2> <p class="text-gray-500">Conteúdo sobre a cultura desta cidade estará disponível em breve.</p></div>`;
            return;
        }
        
        container.innerHTML = `
            <div class="text-center mb-8 md:mb-10">
                <h2 class="text-3xl md:text-5xl font-extrabold mb-3 text-[var(--text-main)] tracking-tight">Cultura e Turismo de ${city.name}</h2>
                <p class="text-base sm:text-lg text-gray-500 max-w-3xl mx-auto">Uma jornada pela história, sabores e belezas que definem este lugar único.</p>
            </div>
            <div class="border-b border-gray-200 mb-6 sm:mb-8">
                <nav class="-mb-px flex space-x-4 sm:space-x-6 justify-center overflow-x-auto scroll-container pb-2">
                    <button onclick="UI.switchCultureTab('history', this)" class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm sm:text-lg">História</button>
                    <button onclick="UI.switchCultureTab('tourism', this)" class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm sm:text-lg">Turismo</button>
                    <button onclick="UI.switchCultureTab('legends', this)" class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm sm:text-lg">Lendas</button>
                    <button onclick="UI.switchCultureTab('people', this)" class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm sm:text-lg">Pessoas</button>
                </nav>
            </div>
            <div id="culture-history-tab" class="tab-content"></div>
            <div id="culture-tourism-tab" class="tab-content hidden"></div>
            <div id="culture-legends-tab" class="tab-content hidden"></div>
            <div id="culture-people-tab" class="tab-content hidden"></div>
        `;
        
        const initialTab = data?.tab || 'history';
        const initialButton = container.querySelector(`.tab-btn[onclick*="'${initialTab}'"]`);
        this.switchCultureTab(initialTab, initialButton || container.querySelector('.tab-btn'));
    },

    switchCultureTab(tabName, clickedButton) {
        document.querySelectorAll('#culture-content .tab-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('#culture-content .tab-content').forEach(content => content.classList.add('hidden'));

        clickedButton.classList.add('active');
        document.getElementById(`culture-${tabName}-tab`).classList.remove('hidden');

        State.clearMapInstances();

        if(tabName === 'history') {
            this.renderCultureHistoryTab();
        } else if (tabName === 'tourism') {
            this.renderCultureTourismTab(true); // Força a reinicialização do mapa
        } else if (tabName === 'legends') {
            this.renderCultureLegendsTab();
        } else if (tabName === 'people') {
            this.renderCulturePeopleTab();
        }
    },

    renderCultureHistoryTab() {
        const container = document.getElementById('culture-history-tab');
        const city = DB.cities.find(c => c.name === State.currentCity);
         container.innerHTML = `
            <div class="space-y-16">
                ${city.culture.timeline ? `
                <section>
                    <h3 class="text-2xl md:text-3xl font-bold mb-8 text-center tracking-tight">Uma Viagem pela História 📜</h3>
                    <div class="timeline">
                        ${city.culture.timeline.map((item, index) => `
                            <div class="timeline-container ${index % 2 === 0 ? 'left' : 'right'}">
                                <div class="timeline-content">
                                    <h4 class="year">${item.year}</h4>
                                    <h5 class="title">${item.title}</h5>
                                    <p class="event-desc">${item.event}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </section>` : ''}
                ${city.culture.gastronomia && city.culture.gastronomia.length > 0 ? `
                <section>
                    <h3 class="text-2xl md:text-3xl font-bold mb-8 text-center tracking-tight">Sabores da Terra 🍲</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        ${city.culture.gastronomia.map(item => `
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden group">
                                <div class="h-48 overflow-hidden">
                                    <img src="${item.imagem}" alt="${item.nome}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                                </div>
                                <div class="p-6">
                                    <h4 class="font-bold text-xl text-gray-800">${item.nome}</h4>
                                    <p class="text-gray-600 mt-2">${item.desc}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </section>` : ''}
                ${city.culture.gallery && city.culture.gallery.length > 0 ? `
                <section>
                    <h3 class="text-2xl md:text-3xl font-bold mb-8 text-center tracking-tight">Galeria da Cidade 🖼️</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        ${city.culture.gallery.map(imgSrc => `
                            <a href="${imgSrc}" target="_blank" class="block rounded-xl overflow-hidden shadow-lg group transform hover:scale-105 transition-transform duration-300">
                                <img src="${imgSrc}" alt="Foto de ${city.name}" class="w-full h-48 object-cover group-hover:brightness-110 transition-all" onerror="this.onerror=null;this.style.display='none';">
                            </a>
                        `).join('')}
                    </div>
                </section>
                ` : ''}
            </div>
        `;
    },

    renderCultureTourismTab(initMap = true) {
        const container = document.getElementById('culture-tourism-tab');
        const city = DB.cities.find(c => c.name === State.currentCity);
        const tourism = city.culture.tourism;

        if (!tourism || !tourism.spots || tourism.spots.length === 0) {
            container.innerHTML = `<p class="text-center text-gray-500 py-10">Informações turísticas para ${city.name} estarão disponíveis em breve.</p>`;
            return;
        }

        const categories = ['Todos', ...new Set(tourism.spots.map(s => s.category))];
        const filteredSpots = State.tourismFilter === 'Todos' 
            ? tourism.spots 
            : tourism.spots.filter(s => s.category === State.tourismFilter);

        if (initMap) {
            container.innerHTML = `
                <div class="space-y-12">
                    <p class="text-lg text-center text-gray-600 max-w-3xl mx-auto">${tourism.intro}</p>
                    <section>
                        <h3 class="text-2xl md:text-3xl font-bold text-center mb-6 tracking-tight">Mapa Interativo 🗺️</h3>
                        <div id="culture-map"></div>
                    </section>
                    <section>
                        <h3 class="text-2xl md:text-3xl font-bold text-center mb-6 tracking-tight">Explore os Pontos Turísticos</h3>
                        <div id="tourism-filters" class="flex overflow-x-auto scroll-container gap-3 mb-8 pb-2 justify-center"></div>
                        <div id="tourism-spots-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
                    </section>
                </div>
            `;
            setTimeout(() => this.initTourismMap(), 100);
        }

        const filtersContainer = document.getElementById('tourism-filters');
        filtersContainer.innerHTML = categories.map(cat => `
            <button onclick="App.filterTourismSpots('${cat}')" class="filter-btn px-4 py-2 text-sm font-semibold rounded-full whitespace-nowrap ${State.tourismFilter === cat ? 'active bg-white border-2' : 'bg-white text-gray-700 hover:bg-gray-100 shadow-sm hover:shadow-md border-2 border-transparent'}">
                ${cat}
            </button>
        `).join('');

        const spotsGrid = document.getElementById('tourism-spots-grid');
        spotsGrid.innerHTML = filteredSpots.map((spot, spotIndex) => `
            <div id="${spot.id}" class="bg-white rounded-2xl shadow-lg overflow-hidden group flex flex-col tourist-spot-card">
                <div class="h-56 overflow-hidden">
                    <img src="${spot.gallery[0]}" alt="Imagem de ${spot.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500 gallery-main-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=Imagem+Indisponível';">
                </div>
                <div class="p-6 flex flex-col flex-grow">
                    <span class="text-sm font-bold text-teal-600 mb-1">${spot.type}</span>
                    <h4 class="text-xl font-bold text-gray-800 mb-2">${spot.name}</h4>
                    <p class="text-gray-600 text-sm flex-grow">${spot.description}</p>
                    <div class="mt-4 p-3 bg-amber-50 border-l-4 border-amber-400 rounded-r-lg">
                        <p class="text-sm text-gray-700"><strong class="font-bold">💡 Dica do Local:</strong> ${spot.tip}</p>
                    </div>
                </div>
            </div>
        `).join('');
    },

    initTourismMap() {
        const city = DB.cities.find(c => c.name === State.currentCity);
        if (!city || !city.culture.tourism.spots) return;

        State.clearMapInstances(); // Garante que não há mapa antigo

        State.tourismMap = L.map('culture-map').setView([city.lat, city.lon], 12);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(State.tourismMap);

        city.culture.tourism.spots.forEach(spot => {
            const marker = L.marker([spot.lat, spot.lon]).addTo(State.tourismMap);
            marker.bindPopup(`
                <div class="popup-content">
                    <img src="${spot.gallery[0]}" class="popup-image">
                    <div class="popup-info">
                        <div class="popup-title">${spot.name}</div>
                        <a onclick="document.getElementById('${spot.id}').scrollIntoView({ behavior: 'smooth' });" class="popup-link">Ver Detalhes ↓</a>
                    </div>
                </div>
            `);
        });
    },

    renderCultureLegendsTab() {
        const container = document.getElementById('culture-legends-tab');
        const city = DB.cities.find(c => c.name === State.currentCity);
        const legends = city.culture.legends;

        if (!legends || legends.length === 0) {
            container.innerHTML = `<p class="text-center text-gray-500 py-10">Nenhuma lenda para ${city.name} foi adicionada ainda.</p>`;
            return;
        }

        container.innerHTML = `
            <div class="space-y-12">
                <h3 class="text-2xl md:text-3xl font-bold text-center tracking-tight">Contos e Mistérios da Região 👻</h3>
                ${legends.map(legend => `
                    <div class="flex flex-col md:flex-row gap-8 bg-white p-4 sm:p-6 rounded-2xl shadow-lg items-center">
                        <div class="w-full md:w-1/3 mb-4 md:mb-0">
                            <img src="${legend.image}" alt="Ilustração para ${legend.title}" class="w-full h-64 object-cover rounded-xl shadow-md" onerror="this.onerror=null;this.src='https://placehold.co/800x600/cccccc/ffffff?text=Ilustração';">
                        </div>
                        <div class="w-full md:w-2/3">
                            <h4 class="text-2xl font-bold text-gray-800 mb-3">${legend.title}</h4>
                            <p class="text-gray-600 leading-relaxed prose">${legend.story}</p>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    },

    renderCulturePeopleTab() {
        const container = document.getElementById('culture-people-tab');
        const city = DB.cities.find(c => c.name === State.currentCity);
        const people = city.culture.peopleStories;

        if (!people || people.length === 0) {
            container.innerHTML = `<p class="text-center text-gray-500 py-10">Nenhuma história de pessoas influentes para ${city.name} foi adicionada ainda.</p>`;
            return;
        }
        
        container.innerHTML = `
            <div class="space-y-12">
                 <h3 class="text-2xl md:text-3xl font-bold text-center tracking-tight">As Pessoas que Fizeram História ❤️</h3>
                ${people.map(person => `
                    <div class="flex flex-col md:flex-row gap-8 bg-white p-4 sm:p-6 rounded-2xl shadow-lg items-center odd:md:flex-row-reverse">
                        <div class="w-full md:w-1/3 mb-4 md:mb-0">
                            <img src="${person.photo}" alt="Foto de ${person.name}" class="w-full h-80 object-cover rounded-xl shadow-md" onerror="this.onerror=null;this.src='https://placehold.co/400x600/cccccc/ffffff?text=Perfil';">
                        </div>
                        <div class="w-full md:w-2/3">
                            <h4 class="text-2xl font-bold text-gray-800 mb-3">${person.name}</h4>
                            <p class="text-gray-600 leading-relaxed prose">${person.story}</p>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    },

    renderFoodGuidePage() {
        const container = document.getElementById('food-guide-content');
        const { searchTerm, delivery, acceptsReservations, outdoorSeating } = State.foodGuideFilters;

        const allRestaurants = DB.companies.filter(c => c.cidade === State.currentCity && c.categorias.includes('Alimentação'));
        
        const filteredRestaurants = allRestaurants.filter(r => {
            const matchesSearch = searchTerm ? r.nome.toLowerCase().includes(searchTerm) || r.descricao.toLowerCase().includes(searchTerm) : true;
            const matchesDelivery = delivery ? r.delivery === true : true;
            const matchesReservations = acceptsReservations ? r.acceptsReservations === true : true;
            const matchesOutdoor = outdoorSeating ? r.outdoorSeating === true : true;
            return matchesSearch && matchesDelivery && matchesReservations && matchesOutdoor;
        });

        container.innerHTML = `
            <div class="text-center mb-10">
                <h2 class="text-3xl md:text-5xl font-extrabold mb-3 text-[var(--text-main)] tracking-tight">Guia Gastronômico 🍔</h2>
                <p class="text-lg text-gray-500 max-w-3xl mx-auto">Encontre os melhores sabores de ${State.currentCity}.</p>
            </div>
            
            <aside class="mb-8">
                <div class="bg-white p-4 sm:p-6 rounded-2xl shadow-lg">
                    <h3 class="text-xl font-bold mb-4">Filtros Especiais</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end">
                        <div class="lg:col-span-2">
                            <label for="food-search-input" class="font-semibold block mb-2 text-sm">Buscar restaurante:</label>
                            <input id="food-search-input" type="text" placeholder="Nome ou tipo de comida..." class="w-full p-2 border border-gray-200 rounded-lg" value="${searchTerm}">
                        </div>
                        <div class="grid grid-cols-2 sm:grid-cols-3 md:flex md:flex-col gap-2">
                             <label class="flex items-center cursor-pointer"><input type="checkbox" id="food-filter-delivery" class="h-4 w-4 text-teal-500 rounded" ${delivery ? 'checked' : ''}><span class="ml-2 text-sm">Faz Delivery</span></label>
                             <label class="flex items-center cursor-pointer"><input type="checkbox" id="food-filter-reservations" class="h-4 w-4 text-teal-500 rounded" ${acceptsReservations ? 'checked' : ''}><span class="ml-2 text-sm">Aceita Reservas</span></label>
                             <label class="flex items-center cursor-pointer"><input type="checkbox" id="food-filter-outdoor" class="h-4 w-4 text-teal-500 rounded" ${outdoorSeating ? 'checked' : ''}><span class="ml-2 text-sm">Área Externa</span></label>
                        </div>
                        <div>
                             <button onclick="App.applyFoodFilters()" class="w-full bg-[var(--primary)] text-white px-6 py-3 rounded-lg font-semibold hover:bg-[var(--primary-dark)]">Aplicar</button>
                        </div>
                    </div>
                </div>
            </aside>
            
            <div id="food-guide-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
                ${filteredRestaurants.length > 0 ? filteredRestaurants.map(this._createCompanyCard).join('') : '<p class="col-span-full text-center text-gray-500 py-10">Nenhum restaurante encontrado com esses filtros.</p>'}
            </div>
        `;
    },

    renderCareersPage() {
        const container = document.getElementById('careers-content');
        container.innerHTML = `
            <div class="text-center mb-10">
                <h2 class="text-3xl md:text-5xl font-extrabold mb-3 text-[var(--text-main)] tracking-tight">Carreiras & Oportunidades 🚀</h2>
                <p class="text-lg text-gray-500 max-w-3xl mx-auto">Construa seu futuro e encontre vagas em nossa comunidade.</p>
            </div>
            <div class="border-b border-gray-200 mb-8">
                <nav class="-mb-px flex space-x-6 justify-center overflow-x-auto scroll-container pb-2">
                    <button onclick="UI.switchCareersTab('guide', this)" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg">Guia de Carreira</button>
                    <button onclick="UI.switchCareersTab('jobs', this)" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg">Vagas de Emprego</button>
                    <button onclick="UI.switchCareersTab('entrepreneurship', this)" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-lg">Empreendedorismo</button>
                </nav>
            </div>
            <div id="careers-guide-tab" class="tab-content"></div>
            <div id="careers-jobs-tab" class="tab-content hidden"></div>
            <div id="careers-entrepreneurship-tab" class="tab-content hidden"></div>
        `;
        this.switchCareersTab('guide', container.querySelector('.tab-btn'));
    },

    switchCareersTab(tabName, clickedButton) {
        document.querySelectorAll('#careers-content .tab-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('#careers-content .tab-content').forEach(content => content.classList.add('hidden'));

        clickedButton.classList.add('active');
        document.getElementById(`careers-${tabName}-tab`).classList.remove('hidden');

        if (tabName === 'guide') {
            this.renderCareerGuideContent();
        } else if (tabName === 'jobs') {
            this.renderJobsContent();
        } else if (tabName === 'entrepreneurship') {
            this.renderEntrepreneurshipContent();
        }
    },

    renderCareerGuideContent() {
      const container = document.getElementById('careers-guide-tab');
      container.innerHTML = `
            <div class="text-center mb-10">
                <h3 class="text-2xl font-bold tracking-tight">Comece a Planejar seu Futuro</h3>
                <p class="text-gray-500 mt-2">Dicas e recursos para sua jornada profissional na região.</p>
           </div>
            <div class="border-b border-gray-200 mb-8">
                <nav id="inner-careers-nav" class="-mb-px flex space-x-4 sm:space-x-6 justify-center overflow-x-auto scroll-container pb-2">
                      <button onclick="UI.switchInnerCareersTab('high-school', this)" class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-base sm:text-lg active">Estou no Ensino Médio</button>
                      <button onclick="UI.switchInnerCareersTab('post-high-school', this)" class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-base sm:text-lg">Terminei o Ensino Médio</button>
                      <button onclick="UI.switchInnerCareersTab('local-opportunities', this)" class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-base sm:text-lg">Oportunidades Locais</button>
                </nav>
           </div>
            <div id="careers-high-school-tab-inner" class="tab-content"></div>
            <div id="careers-post-high-school-tab-inner" class="tab-content hidden"></div>
            <div id="careers-local-opportunities-tab-inner" class="tab-content hidden"></div>
      `;
      this.renderHighSchoolContent();
    },

    switchInnerCareersTab(tabName, clickedButton) {
        const nav = document.getElementById('inner-careers-nav');
        nav.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        clickedButton.classList.add('active');
        
        document.getElementById('careers-high-school-tab-inner').classList.add('hidden');
        document.getElementById('careers-post-high-school-tab-inner').classList.add('hidden');
        document.getElementById('careers-local-opportunities-tab-inner').classList.add('hidden');

        document.getElementById(`careers-${tabName}-tab-inner`).classList.remove('hidden');

        if (tabName === 'high-school') {
            this.renderHighSchoolContent();
        } else if (tabName === 'post-high-school') {
            this.renderPostHighSchoolContent();
        } else if (tabName === 'local-opportunities') {
            this.renderLocalOpportunitiesContent();
        }
    },
    
    renderHighSchoolContent() {
        const data = DB.careerGuide.highSchool;
        const container = document.getElementById('careers-high-school-tab-inner');
        container.innerHTML = `
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <p class="text-center text-gray-600 mb-10">${data.intro}</p>
                
                <h3 class="text-2xl font-bold text-center mb-6 tracking-tight">Descubra Seus Interesses</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                    ${data.interests.map(item => `
                        <div class="career-card bg-teal-50/50 p-6 rounded-xl text-center border border-teal-100">
                            <div class="text-4xl mb-3">${item.icon}</div>
                            <h4 class="font-bold text-lg text-gray-800">${item.title}</h4>
                            <p class="text-sm text-gray-600 mt-2">${item.description}</p>
                        </div>
                    `).join('')}
                </div>

                <h3 class="text-2xl font-bold text-center mb-6 tracking-tight">Dê os Primeiros Passos</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    ${data.firstSteps.map(item => `
                        <div class="career-card bg-white p-6 rounded-xl shadow-md border">
                            <div class="text-3xl mb-3">${item.icon}</div>
                            <h4 class="font-bold text-lg text-gray-800">${item.title}</h4>
                            <p class="text-sm text-gray-600 mt-2">${item.description}</p>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    },

    renderPostHighSchoolContent() {
        const data = DB.careerGuide.postHighSchool;
        const container = document.getElementById('careers-post-high-school-tab-inner');
        container.innerHTML = `
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <p class="text-center text-gray-600 mb-10">${data.intro}</p>
                
                <h3 class="text-2xl font-bold text-center mb-6 tracking-tight">Caminhos a Seguir</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-12">
                    ${data.paths.map(item => `
                        <div class="career-card bg-gray-50 p-6 rounded-xl border">
                            <div class="flex items-start">
                                <div class="text-4xl mr-4">${item.icon}</div>
                                <div>
                                    <h4 class="font-bold text-xl text-gray-800">${item.title}</h4>
                                    <p class="text-sm text-gray-600 mt-2">${item.description}</p>
                                    <div class="mt-3 text-xs">
                                        <p><strong class="text-green-600">Prós:</strong> ${item.pros}</p>
                                        <p><strong class="text-red-600">Contras:</strong> ${item.cons}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <h3 class="text-2xl font-bold text-center mb-6 tracking-tight">Ferramentas para o Sucesso</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    ${data.tools.map(item => `
                        <div class="career-card bg-teal-500 text-white p-6 rounded-xl shadow-lg cursor-pointer" onclick="UI.handleToolClick('${item.id}')">
                            <div class="text-4xl mb-3">${item.icon}</div>
                            <h4 class="font-bold text-lg">${item.title}</h4>
                            <p class="text-sm opacity-90 mt-2">${item.description}</p>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    },

    renderLocalOpportunitiesContent() {
        const data = DB.careerGuide.localOpportunities;
        const container = document.getElementById('careers-local-opportunities-tab-inner');
        container.innerHTML = `
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <p class="text-center text-gray-600 mb-10">${data.intro}</p>
                
                <h3 class="text-2xl font-bold text-center mb-6 tracking-tight">Profissões em Alta na Região</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-12">
                    ${data.professions.map(item => `
                        <div class="career-card bg-gray-50 p-6 rounded-xl border">
                            <div class="flex items-start">
                                <div class="text-4xl mr-4">${item.icon}</div>
                                <div>
                                    <h4 class="font-bold text-xl text-gray-800">${item.title}</h4>
                                    <p class="text-sm text-gray-600 mt-2">${item.description}</p>
                                    <p class="text-sm text-teal-700 font-semibold mt-3">Formação: ${item.needs}</p>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <h3 class="text-2xl font-bold text-center mb-6 tracking-tight">Onde Estudar na Região</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                    ${data.institutions.map(item => `
                         <a href="${item.link}" target="_blank" class="career-card block bg-white p-6 rounded-xl shadow-md border hover:bg-teal-50 text-center">
                            <h4 class="font-bold text-lg text-teal-700">${item.name} →</h4>
                        </a>
                    `).join('')}
                </div>
            </div>
        `;
    },

    renderJobsContent() {
        const container = document.getElementById('careers-jobs-tab');
        const jobsInCity = DB.jobs.filter(job => job.cidade === State.currentCity);

        if (jobsInCity.length === 0) {
            container.innerHTML = `<div class="bg-white rounded-2xl shadow-lg p-10 text-center"><p class="text-gray-500">Nenhuma vaga de emprego disponível em ${State.currentCity} no momento.</p></div>`;
            return;
        }

        container.innerHTML = `
            <div class="space-y-6">
                ${jobsInCity.map(job => `
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-teal-500">
                        <div class="flex flex-col md:flex-row justify-between items-start">
                            <div>
                                <h4 class="text-xl font-bold text-gray-800">${job.title}</h4>
                                <p class="text-md text-gray-600 font-medium">${job.company}</p>
                            </div>
                            <p class="mt-2 md:mt-0 text-sm text-gray-500">📍 ${job.cidade}</p>
                        </div>
                        <p class="my-4 text-gray-700">${job.description}</p>
                        <div>
                            <h5 class="font-bold text-sm mb-2">Requisitos:</h5>
                            <ul class="list-disc list-inside text-sm text-gray-600">
                                ${job.requirements.map(req => `<li>${req}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-100 text-right">
                             <a href="mailto:${job.contact}" class="bg-teal-500 text-white font-bold py-2 px-6 rounded-full hover:bg-teal-600 transition-colors">Entrar em Contato</a>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    },

    renderEntrepreneurshipContent() {
        const container = document.getElementById('careers-entrepreneurship-tab');
        const data = DB.careerGuide.entrepreneurship;

        container.innerHTML = `
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 space-y-12">
                <section class="text-center">
                    <h3 class="text-2xl md:text-3xl font-bold tracking-tight">O Guia do Jovem Empreendedor</h3>
                    <p class="mt-3 text-gray-600 max-w-3xl mx-auto">${data.intro}</p>
                </section>

                <section>
                    <h4 class="text-xl md:text-2xl font-bold text-center mb-8 tracking-tight">Os Primeiros Passos Para Tirar Sua Ideia do Papel</h4>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        ${data.firstSteps.map(item => `
                            <div class="career-card bg-teal-50/50 p-6 rounded-xl text-center border border-teal-100 flex flex-col">
                                <div class="text-4xl mb-3">${item.icon}</div>
                                <h5 class="font-bold text-lg text-gray-800">${item.title}</h5>
                                <p class="text-sm text-gray-600 mt-2 flex-grow">${item.description}</p>
                            </div>
                        `).join('')}
                    </div>
                </section>

                <section>
                    <h4 class="text-xl md:text-2xl font-bold text-center mb-8 tracking-tight">💡 Ideias de Negócios Para a Região</h4>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        ${data.businessIdeas.map(item => `
                             <div class="career-card bg-white p-6 rounded-xl shadow-md border flex items-start gap-4">
                                <div class="text-3xl">${item.icon}</div>
                                <div>
                                    <h5 class="font-bold text-lg text-gray-800">${item.title}</h5>
                                    <p class="text-sm text-gray-600 mt-1">${item.description}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </section>

                 <section>
                    <h4 class="text-xl md:text-2xl font-bold text-center mb-8 tracking-tight">Desafios Comuns (e Como Superá-los)</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                         ${data.commonChallenges.map(item => `
                            <div class="career-card bg-amber-50 p-6 rounded-xl border border-amber-200">
                                <h5 class="font-bold text-lg text-amber-800">${item.title}</h5>
                                <p class="text-sm text-gray-700 mt-2"><strong class="text-amber-900">Dica:</strong> ${item.tip}</p>
                            </div>
                        `).join('')}
                    </div>
                </section>

                <section>
                    <h4 class="text-xl md:text-2xl font-bold text-center mb-8 tracking-tight">Inspiração Local: Histórias de Sucesso</h4>
                     <div class="space-y-10">
                        ${data.localStories.map(person => `
                            <div class="flex flex-col md:flex-row gap-8 bg-white p-4 sm:p-6 rounded-2xl shadow-lg items-center odd:md:flex-row-reverse">
                                <div class="w-full md:w-1/3 mb-4 md:mb-0">
                                    <img src="${person.photo}" alt="Foto de ${person.name}" class="w-full h-80 object-cover rounded-xl shadow-md" onerror="this.onerror=null;this.src='https://placehold.co/400x600/cccccc/ffffff?text=Perfil';">
                                </div>
                                <div class="w-full md:w-2/3">
                                    <h5 class="text-2xl font-bold text-gray-800">${person.name}</h5>
                                    <p class="text-md text-teal-600 font-semibold mb-3">${person.business}</p>
                                    <p class="text-gray-600 leading-relaxed">${person.story}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </section>

                <section>
                    <h4 class="text-xl md:text-2xl font-bold text-center mb-8 tracking-tight">Recursos e Ferramentas</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        ${data.resources.map(item => `
                            <a href="${item.link}" target="_blank" class="career-card block bg-white p-6 rounded-xl shadow-md border hover:bg-teal-50">
                                <h5 class="font-bold text-lg text-teal-700">${item.name} →</h5>
                                <p class="text-sm text-gray-600 mt-2">${item.description}</p>
                            </a>
                        `).join('')}
                    </div>
                </section>
            </div>
        `;
    },
    
    renderReviewsChart(reviews) {
        const ctx = document.getElementById('reviewsChart')?.getContext('2d');
        if (!ctx) return;
        
        const ratingCounts = [0, 0, 0, 0, 0]; 
        reviews.forEach(r => {
            if (r.nota >= 1 && r.nota <= 5) {
                ratingCounts[r.nota - 1]++;
            }
        });

        if (State.chartInstance) {
            State.chartInstance.destroy();
        }

        const labels = ['1 ★', '2 ★', '3 ★', '4 ★', '5 ★'];
        const colors = ['#ef5350', '#ffa726', '#ffd54f', '#66bb6a', '#26a69a'];

        State.chartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Nº de Avaliações',
                    data: ratingCounts,
                    backgroundColor: colors,
                    borderColor: 'rgba(255, 255, 255, 0.5)',
                    borderWidth: 1,
                    borderRadius: 8,
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true, maintainAspectRatio: false,
                scales: { 
                    y: { 
                        grid: { display: false },
                        ticks: { font: { size: 14, family: 'Nunito' } }
                    },
                    x: { 
                        beginAtZero: true, 
                        ticks: { precision: 0, font: { family: 'Nunito' } }
                    } 
                },
                plugins: { 
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#546E7A',
                        titleFont: { size: 16, weight: 'bold', family: 'Nunito' },
                        bodyFont: { size: 14, family: 'Nunito' },
                        padding: 12,
                        cornerRadius: 12,
                    }
                }
            }
        });
    },
    
    openModal(modalId) {
        const modal = document.getElementById(modalId);
        const modalContent = document.getElementById(`${modalId}-content`);
        if(modalId === 'quote-modal'){
            document.getElementById('quote-form-container').classList.remove('hidden');
            document.getElementById('quote-success-message').classList.add('hidden');
        }
        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.classList.remove('opacity-0');
            modalContent.classList.remove('scale-95');
        }, 10);
    },

    closeModal(modalId) {
        const modal = document.getElementById(modalId);
        const modalContent = document.getElementById(`${modalId}-content`);
        modal.classList.add('opacity-0');
        modalContent.classList.add('scale-95');
        setTimeout(() => modal.classList.add('hidden'), 300);
    },

    openCvModal() {
        document.getElementById('cv-content').innerHTML = DB.careerGuide.cvModel;
        this.openModal('cv-modal');
    },

    handleToolClick(toolId) {
        if (toolId === 'cv') {
            this.openCvModal();
        }
        if (toolId === 'interview' || toolId === 'courses') {
            alert('Esta funcionalidade será implementada em breve!');
        }
    },
    
    showQuoteSuccess() {
        document.getElementById('quote-form-container').classList.add('hidden');
        document.getElementById('quote-success-message').classList.remove('hidden');
    },

    handleScroll() {
        const btn = document.getElementById('scrollToTopBtn');
        if (window.scrollY > 300) {
            btn.classList.remove('opacity-0', 'translate-y-4');
        } else {
            btn.classList.add('opacity-0', 'translate-y-4');
        }
    }
};

const Utils = {
    renderStars(rating) {
        let stars = '';
        const fullStars = Math.floor(rating);
        const halfStar = rating % 1 >= 0.5;
        const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
        
        for (let i = 0; i < fullStars; i++) stars += `<span class="text-amber-400">★</span>`;
        if (halfStar) stars += `<span class="text-amber-400">★</span>`;
        for (let i = 0; i < emptyStars; i++) stars += `<span class="text-gray-300">★</span>`;
        
        return `<div class="flex items-center text-xl">${stars}</div>`;
    },

    calculateAverageRating(reviews) {
        if (!reviews || reviews.length === 0) return 0;
        return reviews.reduce((sum, review) => sum + review.nota, 0) / reviews.length;
    },
    
    getTodaysHours(company) {
        const weekdays = ["domingo", "segunda", "terca", "quarta", "quinta", "sexta", "sabado"];
        const todayIndex = new Date().getDay();
        const todayKey = weekdays[todayIndex];
        return company.horario_funcionamento[todayKey] || "Fechado";
    },

    isCompanyOpen(company) {
        const now = new Date();
        const weekdays = ["domingo", "segunda", "terca", "quarta", "quinta", "sexta", "sabado"];
        
        const checkSchedule = (dayIndex, referenceDate) => {
            const dayKey = weekdays[dayIndex];
            const hours = company.horario_funcionamento[dayKey];

            if (!hours || hours === 'Fechado') return false;

            const [openTime, closeTime] = hours.split('-');
            const [openHour, openMin] = openTime.split(':').map(Number);
            const [closeHour, closeMin] = closeTime.split(':').map(Number);
            
            const openDate = new Date(referenceDate);
            openDate.setHours(openHour, openMin, 0, 0);

            const closeDate = new Date(referenceDate);
            closeDate.setHours(closeHour, closeMin, 0, 0);

            if (closeDate <= openDate) {
                closeDate.setDate(closeDate.getDate() + 1);
            }
            
            return now >= openDate && now < closeDate;
        };
        
        if (checkSchedule(now.getDay(), now)) {
            return true;
        }

        const yesterday = new Date(now);
        yesterday.setDate(now.getDate() - 1);
        if (checkSchedule(yesterday.getDay(), yesterday)) {
            return true;
        }

        return false;
    },
    
    getOpenStatusBadge(company, extraClasses = 'absolute top-2 left-2') {
        if (this.isCompanyOpen(company)) {
            return `<div class="${extraClasses} text-xs font-bold px-2.5 py-1 rounded-full bg-green-100 text-green-800 shadow-sm">Aberto</div>`;
        } else {
            return `<div class="${extraClasses} text-xs font-bold px-2.5 py-1 rounded-full bg-red-100 text-red-800 shadow-sm">Fechado</div>`;
        }
    },

    formatCountdown(targetDate) {
        const now = new Date().getTime();
        const target = new Date(targetDate).getTime();
        const distance = target - now;

        if (distance < 0) return null;

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        let result = '';
        if (days > 0) result += `${days}d `;
        if (hours > 0 || days > 0) result += `${String(hours).padStart(2, '0')}h `;
        if (minutes > 0 || hours > 0 || days > 0) result += `${String(minutes).padStart(2, '0')}m `;
        result += `${String(seconds).padStart(2, '0')}s`;

        return result.trim();
    }
};

App.init();

</script>

</body>
</html>